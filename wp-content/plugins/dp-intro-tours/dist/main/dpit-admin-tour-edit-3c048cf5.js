/*!
 * 
 * Intro Tour Tutorial
 * 
 * @author [object Object]
 * @version 6.4.4
 * @link http://www.gnu.org/licenses/gpl-2.0.txt
 * @license GPL-2.0+
 * 
 * Copyright (c) 2023 [object Object]
 * 
 * This plugin is released under GPL-2.0+ license to be included in wordpres.org plugin repository
 * 
 * Compiled with the help of https://wpack.io
 * A zero setup Webpack Bundler Script for WordPress
 */
(window.wpackiodpIntroToursmainJsonp=window.wpackiodpIntroToursmainJsonp||[]).push([[32],{12:function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return o}));const s=function(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t){let o="";s&&(o=t.style.transition,t.style.transition="unset"),t.classList.add("dpit-hidden"),e||t.classList.add("dpit-hidden--by-disp"),i&&t.classList.add("dpit-hidden--no-space"),s&&setTimeout(()=>{t.style.transition=o},50)}},o=t=>{t&&t.classList.remove("dpit-hidden","dpit-hidden--no-space","dpit-hidden--by-disp","dpit-hidden-keep-events")}},14:function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));var s=i(3),o=i(5),n=i.n(o);var a=i(23);class l extends class{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"dpit-btn",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],l=arguments.length>5&&void 0!==arguments[5]&&arguments[5],r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"div";Object(s.a)(this,"onClickHandler",t=>{if(this.bulletsAnimation.isRunning)return t.stopPropagation(),t.preventDefault(),!1;this.onClickCB instanceof Function&&this.onClickCB({state:this.currentState,button:this})}),this.element=document.createElement(c),r&&(this.element.id=r),this.element.setAttribute("role","button"),this.element.className="string"==typeof a?n()([o,a]):n()([o,[...a]]),this.element.addEventListener("click",this.onClickHandler),this.btnBemClass=o,this.initStates(e,o),this.setOnlyState(i),this.onClickCB=t,l&&this.deactivate()}activate(){this.removeStateClass("inactive")}deactivate(){this.addStateClass("inactive")}renderContent(t,e){if(null!=e){if(e instanceof HTMLElement)return t.appendChild(e),!0;if("string"==typeof e)return t.innerHTML=e,!0}return!1}initStates(t,e){this.stateOptions={},this.stateKeys=Object.keys(t),this.stateKeys.forEach(i=>{const s=document.createElement("div"),o=e+"__content";s.classList.add(o),s.classList.add(o+"--"+i);const n=t[i];if(n){let t=null,e=null;"object"==typeof n?(t=n.content,e={...n,element:s}):(t=n,e={content:n,element:s}),this.renderContent(s,t)&&(this.element.appendChild(s),this.stateOptions[i]=e)}})}getButtonElement(){return this.element}destroy(){var t;null===(t=this.element)||void 0===t||t.removeEventListener("click",this.onClickHandler)}deactivateAll(){this.setOnlyState()}clearActiveClasses(t){if(t){const e=this.stateOptions[t];this.removeStateClass(e.activeMod),null!=e&&e.activeClass&&this.element.classList.remove(e.activeClass)}}setActiveClasses(t){const e=this.stateOptions[t];e&&(this.addStateClass(e.activeMod),null!=e&&e.activeClass&&this.element.classList.add(e.activeClass))}removeStateClass(t){t&&this.element.classList.remove(this.btnBemClass+"--"+t)}addStateClass(t){t&&this.element.classList.add(this.btnBemClass+"--"+t)}setOnlyStateTemporarily(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3;e=e||this.currentState,this.setOnlyState(t),e&&setTimeout(()=>{this.setOnlyState(e)},i)}setOnlyState(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.removeStateClass(this.currentState),this.clearActiveClasses(this.currentState),this.stateKeys.forEach(e=>{var i;null!==(i=this.stateOptions[e])&&void 0!==i&&i.element&&(t===e&&(this.addStateClass(e),this.setActiveClasses(e)),this.stateOptions[e].element.style.display=t===e?"":"none")}),this.currentState=t}}{constructor(t){let e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"dpit-admin-btn";super(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default",e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],arguments.length>5&&void 0!==arguments[5]&&arguments[5],arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",arguments.length>7&&void 0!==arguments[7]?arguments[7]:"div"),this.bulletsAnimation=new a.a(this.element,e+"__anim",90,12,5,3)}startAnimation(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.isAnimated=!0,this.bulletsAnimation.start(t,e,()=>this.onAnimationEnded(i)),this.element.style.setProperty("pointer-events","none"),this.element.style.setProperty("cursor","default"),this.addStateClass("anim")}stopAnimation(){this.bulletsAnimation.stop(),this.element.style.removeProperty("pointer-events"),this.element.style.removeProperty("cursor"),this.removeStateClass("anim"),this.isAnimated=!1}onAnimationEnded(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.stopAnimation(),t&&t()}hideStateItems(){this.stateKeys.forEach(t=>{const e=this.stateOptions[t].element;e&&(e.style.opacity=0)})}showStateItems(){this.stateKeys.forEach(t=>{const e=this.stateOptions[t].element;e&&(e.style.opacity="")})}}},15:function(t,e,i){"use strict";window.DpitHooks||(window.DpitHooks={}),DpitHooks.actions=DpitHooks.actions||{},DpitHooks.filters=DpitHooks.filters||{},DpitHooks.init=function(t){DpitHooks.dpDebugEn=t,t&&console.log("[dpit] INIT DpitHooks")},DpitHooks.addAction=function(t,e,i){void 0===i&&(i=10),DpitHooks.actions[t]=DpitHooks.actions[t]||[],DpitHooks.actions[t].push({priority:i,callback:e})},DpitHooks.addFilter=function(t,e,i){void 0===i&&(i=10),DpitHooks.filters[t]=DpitHooks.filters[t]||[],DpitHooks.filters[t].push({priority:i,callback:e})},DpitHooks.removeAction=function(t,e){DpitHooks.actions[t]=DpitHooks.actions[t]||[],DpitHooks.actions[t].forEach((i,s)=>{i.callback===e&&DpitHooks.actions[t].splice(s,1)})},DpitHooks.removeFilter=function(t,e){DpitHooks.filters[t]=DpitHooks.filters[t]||[],DpitHooks.filters[t].forEach((i,s)=>{i.callback===e&&DpitHooks.filters[t].splice(s,1)})},DpitHooks.doAction=function(t,e){const i=[];DpitHooks.dpDebugEn&&console.log("[dpit] API Action > Tag:",t,", Subscribed:",DpitHooks.actions[t]?DpitHooks.actions[t].length:0,", Args:",e),void 0!==DpitHooks.actions[t]&&DpitHooks.actions[t].length>0&&(DpitHooks.actions[t].forEach(t=>{i[t.priority]=i[t.priority]||[],i[t.priority].push(t.callback)}),i.forEach(t=>{t.forEach(t=>{t(e)})}))},DpitHooks.applyFilters=function(t,e,i){const s=[];let o=e;return DpitHooks.dpDebugEn&&console.log("[dpit] API Filter > Tag:",t,", Subscribed count:",DpitHooks.filters[t]?DpitHooks.filters[t].length:0,", Args:",i),void 0!==DpitHooks.filters[t]&&DpitHooks.filters[t].length>0&&(DpitHooks.filters[t].forEach(t=>{s[t.priority]=s[t.priority]||[],s[t.priority].push(t.callback)}),s.forEach(t=>{t.forEach(t=>{o=t(o,i)})})),o},e.a=DpitHooks},179:function(t,e,i){i(10),t.exports=i(184)},180:function(t,e,i){var s,o,n;
/*!
	autosize 4.0.4
	license: MIT
	http://www.jacklmoore.com/autosize
*/o=[t,e],void 0===(n="function"==typeof(s=function(t,e){"use strict";var i,s,o="function"==typeof Map?new Map:(i=[],s=[],{has:function(t){return i.indexOf(t)>-1},get:function(t){return s[i.indexOf(t)]},set:function(t,e){-1===i.indexOf(t)&&(i.push(t),s.push(e))},delete:function(t){var e=i.indexOf(t);e>-1&&(i.splice(e,1),s.splice(e,1))}}),n=function(t){return new Event(t,{bubbles:!0})};try{new Event("test")}catch(t){n=function(t){var e=document.createEvent("Event");return e.initEvent(t,!0,!1),e}}function a(t){if(t&&t.nodeName&&"TEXTAREA"===t.nodeName&&!o.has(t)){var e,i=null,s=null,a=null,l=function(){t.clientWidth!==s&&h()},r=function(e){window.removeEventListener("resize",l,!1),t.removeEventListener("input",h,!1),t.removeEventListener("keyup",h,!1),t.removeEventListener("autosize:destroy",r,!1),t.removeEventListener("autosize:update",h,!1),Object.keys(e).forEach((function(i){t.style[i]=e[i]})),o.delete(t)}.bind(t,{height:t.style.height,resize:t.style.resize,overflowY:t.style.overflowY,overflowX:t.style.overflowX,wordWrap:t.style.wordWrap});t.addEventListener("autosize:destroy",r,!1),"onpropertychange"in t&&"oninput"in t&&t.addEventListener("keyup",h,!1),window.addEventListener("resize",l,!1),t.addEventListener("input",h,!1),t.addEventListener("autosize:update",h,!1),t.style.overflowX="hidden",t.style.wordWrap="break-word",o.set(t,{destroy:r,update:h}),"vertical"===(e=window.getComputedStyle(t,null)).resize?t.style.resize="none":"both"===e.resize&&(t.style.resize="horizontal"),i="content-box"===e.boxSizing?-(parseFloat(e.paddingTop)+parseFloat(e.paddingBottom)):parseFloat(e.borderTopWidth)+parseFloat(e.borderBottomWidth),isNaN(i)&&(i=0),h()}function c(e){var i=t.style.width;t.style.width="0px",t.offsetWidth,t.style.width=i,t.style.overflowY=e}function d(){if(0!==t.scrollHeight){var e=function(t){for(var e=[];t&&t.parentNode&&t.parentNode instanceof Element;)t.parentNode.scrollTop&&e.push({node:t.parentNode,scrollTop:t.parentNode.scrollTop}),t=t.parentNode;return e}(t),o=document.documentElement&&document.documentElement.scrollTop;t.style.height="",t.style.height=t.scrollHeight+i+"px",s=t.clientWidth,e.forEach((function(t){t.node.scrollTop=t.scrollTop})),o&&(document.documentElement.scrollTop=o)}}function h(){d();var e=Math.round(parseFloat(t.style.height)),i=window.getComputedStyle(t,null),s="content-box"===i.boxSizing?Math.round(parseFloat(i.height)):t.offsetHeight;if(s<e?"hidden"===i.overflowY&&(c("scroll"),d(),s="content-box"===i.boxSizing?Math.round(parseFloat(window.getComputedStyle(t,null).height)):t.offsetHeight):"hidden"!==i.overflowY&&(c("hidden"),d(),s="content-box"===i.boxSizing?Math.round(parseFloat(window.getComputedStyle(t,null).height)):t.offsetHeight),a!==s){a=s;var o=n("autosize:resized");try{t.dispatchEvent(o)}catch(t){}}}}function l(t){var e=o.get(t);e&&e.destroy()}function r(t){var e=o.get(t);e&&e.update()}var c=null;"undefined"==typeof window||"function"!=typeof window.getComputedStyle?((c=function(t){return t}).destroy=function(t){return t},c.update=function(t){return t}):((c=function(t,e){return t&&Array.prototype.forEach.call(t.length?t:[t],(function(t){return a(t)})),t}).destroy=function(t){return t&&Array.prototype.forEach.call(t.length?t:[t],l),t},c.update=function(t){return t&&Array.prototype.forEach.call(t.length?t:[t],r),t}),e.default=c,t.exports=e.default})?s.apply(e,o):s)||(t.exports=n)},184:function(t,e,i){"use strict";i.r(e);var s=i(9),o=i.n(s),n=i(3),a=i(21),l=(i(43),i(44),i(57),i(45),i(4));class r{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Object(n.a)(this,"init",t=>{$("#post-body-content .acf-field:not(.acf-field-group):not(.acf-field--no-info-icon) .acf-label").each((t,e)=>{const i=$(e).find(".description"),s=$(e).closest(".acf-field"),o=s.find("span.message");let n=i.html(),a=o.html()||"";if(a&&n&&(a+="<br>"),a+=i.html()||"",a.length){const t=s.hasClass("acf-field--ia")?"dpit-info-icon dpit-info-icon--ia":"dpit-info-icon";$(e).addClass("acf-label--with-info-icon").append(Object(l.n)(t,a,$(e).children("label").text())),i.add(o).hide()}}),t.stepDefinitions&&Object.keys(t.stepDefinitions).forEach(e=>{const i=t.stepDefinitions[e];i.hint&&$("#acf-t-header-"+e).addClass("acf-table-header-cell--with-info-icon").append(Object(l.n)("dpit-info-icon dpit-info-icon--in-table-header",i.hint,i.title.replace(/(<([^>]+)>)/gi,"")))}),$(".dpit-info-icon").each((t,e)=>{const i=$(e).hasClass("dpit-info-icon--ia"),s=$(e).hasClass("dpit-info-icon--modal")?"light-border":"material";Object(a.b)(e,{content:t=>t.getAttribute("data-info-text"),animation:"scale",theme:s,allowHTML:!0,interactive:i,zIndex:100000003})}),setTimeout(()=>{var e;null===(e=document.getElementById(t.acfRootElId))||void 0===e||e.classList.add("dpit-acf-tippy");const i=document.querySelector(".dpit-info-icon");i&&$(i).load(o()(t.assetsUrl,"../../includes/assets/icons/info-circle-solid.svg"),()=>this.onInfoIconLoaded(i))},300)}),Object(n.a)(this,"onInfoIconLoaded",t=>{const e=$(".dpit-info-icon");e.html(t.innerHTML),e.addClass("dpit-info-icon--loaded"),e.show(),this.onInitializedCb instanceof Function&&this.onInitializedCb()}),t.dpDebugEn&&console.log("[dpit] INIT AcfTippy"),this.onInitializedCb=e,this.init(t)}reloadInfoIcons(){const t=document.querySelector(".dpit-info-icon--loaded");if(t){$(".dpit-info-icon:not(.dpit-info-icon--loaded)").html(t.innerHTML)}}}var c=i(48),d=i(19),h=i(49),p=i(5),u=i.n(p);class b{constructor(t){Object(n.a)(this,"classes",{btn_small:"acf-icon acf-icon--s",btn_very_small:"acf-icon acf-icon--xs",btn_very_very_small:"acf-icon acf-icon--xxs",btn_add_row:"acf-icon-plus -plus",btn_remove_row:"acf-icon-minus -minus"}),Object(n.a)(this,"htmleditor",'<div class="acf-table-cell-editor"><textarea name="acf-table-cell-editor-textarea" class="acf-table-cell-editor-textarea"></textarea></div>'),this.config=t,this.htmlButtons={add_row:'<a href="#" class="acf-table-add-row no-drag '.concat(this.classes.btn_small," ").concat(this.classes.btn_add_row,'"></a>'),remove_row:'<a href="#" class="acf-table-remove-row '.concat(this.classes.btn_small," ").concat(this.classes.btn_remove_row,'"></a>'),add_link:'<a href="#" class="acf-table-add-link no-drag '.concat(this.classes.btn_small," ").concat(this.classes.btn_add_row,'"></a>'),remove_link:'<a href="#" class="acf-table-remove-link no-drag '.concat(this.classes.btn_very_very_small," ").concat(this.classes.btn_remove_row,'"></a>')},this.body_row="".concat('<div class="acf-table-body-row"><div class="acf-table-body-left">').concat(this.htmlButtons.add_row,'<div class="acf-table-body-left-wrap">')+'<div class="acf-table-body-cont">\x3c!--ph--\x3e</div><div class="acf-table-sort-row-icon"></div></div></div>'+'<div class="acf-table-body-right">'.concat(this.htmlButtons.remove_row,"</div>")+"</div>",this.top_cell='<div class="acf-table-top-cell" data-colparam=""><div class="acf-table-top-cont">\x3c!--ph--\x3e</div></div>',this.table='<div class="acf-table-wrap'.concat($.isEmptyObject(t.text_styles)?"":" acf-table-wrap--cs dpit-scrollbar",'">')+'<div class="acf-table-table"><div class="acf-table-top-row"><div class="acf-table-top-left"></div><div class="acf-table-top-right"></div></div><div class="acf-table-header-row acf-table-header-hide-off"><div class="acf-table-header-left">'+this.htmlButtons.add_row+'</div><div class="acf-table-header-right"></div></div><div class="acf-table-bottom-row"><div class="acf-table-bottom-left"></div><div class="acf-table-bottom-right"></div></div></div></div>'}header_cell(t,e,i){const s=["acf-table-header-cell"];return e&&s.push(e),'<div class="'.concat(s.join(" "),'"').concat(i?' id="acf-t-header-'.concat(i,'"'):"",'>\n\t\t\t\t<div class="acf-table-header-cont" data-val="').concat(i,'">').concat(t,"</div>\n\t\t\t</div>")}body_cell(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",n=this.extra_data(i,!0);const a=s?' id="'+s+'"':"",l=["acf-table-body-cell"];return e&&l.push(e),"<div".concat(a,' class="').concat(u()(l),'" title="').concat(o,'">')+'<div class="acf-table-body-cont">'.concat(t).concat(n,"</div>")+"</div>"}body_cell_link(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",o=null,n="";if(0===(arguments.length>3&&void 0!==arguments[3]?arguments[3]:0)){o="acf-table-body-cell--link-multi",n="dpit-admin-first-step-link-cell";const e=t.split(",").filter(t=>t);t='<div class="acf-table-body-cell__title">',t+=this.config.i18n.tour_starts_at,t+="</div>",t+="<ul>",e&&e.length&&e.forEach(e=>{t+=this.body_cell_link_sub_item(e)}),t+="</ul>",t+=this.htmlButtons.add_link,t+='<div id="dpit-admin-step-link-cell-everywhere">',t+=this.config.i18n.EVERYWHERE,t+="</div>"}return e&&(e+=" "),this.body_cell(t,u()([e,o]),i,n,s)}body_cell_link_sub_item(){return'<li class="acf-table-body-cont-li"><span>'.concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"","</span>").concat(this.htmlButtons.remove_link,"</li>")}body_cell_checkbox(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3?arguments[3]:void 0,o=this.extra_data(i,t);const n=["acf-table-body-cell"];e&&n.push(e);const a=t?" checked":"";return'<div class="'.concat(n.join(" "),'" title="').concat(s,'">')+'<div class="acf-table-body-cont acf-table-body-cont--checkbox">'+'<input type="checkbox" class="acf-table-body-cont-sub"'.concat(a,">")+o+"</div></div>"}body_cell_select(t,e,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";const o=["acf-table-body-cont-sub"];return i&&o.push(i),'<div class="acf-table-body-cell" title="'.concat(s,'">')+'<div class="acf-table-body-cont acf-table-body-cont--select">'+'<select class="'.concat(o.join(" "),'">')+t.map(t=>{const i=t.split(":"),s=i[0],o=i.length>1?i[1]:i[0],n=s==e?' selected="selected"':"";return'<option value="'.concat(s,'"').concat(n,">").concat(o,"</option>")}).join("")+"</select></div></div>"}extra_data(t,e){let i="";if(t&&!jQuery.isEmptyObject(t)){const s=u()({"acf-table-cell-ec":!0,"acf-table-cell-ec--hidden":!e});i+='<div class="'.concat(s,'">'),Object.keys(t).forEach(e=>{var s;const o=t[e];switch(o.title&&(i+='<div class="acf-cell-eci-wrap" data-id="'.concat(e,'">')),o.type){case"checkbox":i+='<input type="checkbox" class="acf-table-body-cont-sub"'.concat(1==o.val?" checked":"",">");break;case"number":{var n;const t=void 0!==o.min&&null!==o.min?' min="'.concat(o.min,'"'):"",e=void 0!==o.max&&null!==o.max?' max="'.concat(o.max,'"'):"",s=void 0!==o.step&&null!==o.step?' step="'.concat(o.step,'"'):"";i+='<input type="number"'.concat(t).concat(e).concat(s,' class="acf-table-body-cont-sub" value="').concat(null!==(n=o.val)&&void 0!==n?n:o.def,'">')}break;default:i+='<input type="text" class="acf-table-body-cont-sub" value="'.concat(null!==(s=o.val)&&void 0!==s?s:o.def,'">')}o.title&&(i+="<span>".concat(o.title,"</span>")),(o.hint||o.title)&&(i+=Object(l.n)("dpit-info-icon dpit-info-icon--modal dpit-info-icon--interaction",o.hint,o.title,!1)),i+="</div>"}),i+="</div>"}return i}}class f{constructor(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;Object(n.a)(this,"stopClickPropagation",t=>(t&&(t.stopImmediatePropagation(),t.preventDefault()),!1)),this.dragData={x:null,left:null,target:null},this.minDragPositionChangePx=s,this.excludedSelectors=i.join(","),this.handlerSelector=e,this.containerEl=t,this.$containerEl=$(t),this.isContainerScrollable=this.isContainerScrollableFce(),this.$dragAndDropHandler=this.$containerEl.find(e).not(this.excludedSelectors),this.setDraggingInProcess(!1),this.$dragAndDropHandler.on("mousedown",this.onMouseDown.bind(this)),document.addEventListener("mousemove",this.onMouseMove.bind(this)),document.addEventListener("mouseup",this.onMouseUp.bind(this)),$(window).on("resize",this.onContainerResize.bind(this))}setDraggingInProcess(t){this.isDragging=!!this.isContainerScrollable&&t,this.isDraggingConfirmed=!1,this.adjustCursor()}refresh(){this.$dragAndDropHandler.off("mousedown",this.onMouseDown),this.$dragAndDropHandler=this.$containerEl.find(this.handlerSelector).not(this.excludedSelectors),this.setDraggingInProcess(!1),this.$dragAndDropHandler.on("mousedown",this.onMouseDown.bind(this))}adjustCursor(){var t;null!==(t=this.dragData)&&void 0!==t&&t.target&&(this.isContainerScrollable&&this.isDragging?this.dragData.target.style.cursor="grabbing":this.dragData.target.style.cursor="")}onContainerResize(){this.setDraggingInProcess(!1)}isContainerScrollableFce(){const t=this.$containerEl.width(),e=parseInt(window.getComputedStyle(this.containerEl)["padding-left"],10),i=parseInt(window.getComputedStyle(this.containerEl)["padding-right"],10);let s=0;return isNaN(e)||(s+=e),isNaN(i)||(s+=i),this.containerEl.scrollWidth-s-1>t}isExcludedSelector(t){return $(t).is(this.excludedSelectors)||$(t).closest(this.excludedSelectors).length>0}onMouseDown(t){if(this.isExcludedSelector(t.target))return!0;this.dragData={left:this.containerEl.scrollLeft,x:t.clientX,target:t.target},this.setDraggingInProcess(!0),this.onBlockClickTimeout&&clearTimeout(),this.unblockClick()}onMouseUp(t){if(this.isDragging){this.setDraggingInProcess(!1);Math.abs(t.clientX-this.dragData.x)>this.minDragPositionChangePx?(this.blockClick(),this.onBlockClickTimeout&&clearTimeout(),this.onBlockClickTimeout=setTimeout(()=>{this.unblockClick()},200)):this.unblockClick()}else this.unblockClick()}blockClick(){this.dragData&&($(this.dragData.target).on("mousedown",this.stopClickPropagation),$(this.dragData.target).on("click",this.stopClickPropagation))}unblockClick(){var t,e;this.dragData&&($(null===(t=this.dragData)||void 0===t?void 0:t.target).off("mousedown",this.stopClickPropagation),$(null===(e=this.dragData)||void 0===e?void 0:e.target).off("click",this.stopClickPropagation))}onMouseMove(t){if(this.isDragging){if(this.isExcludedSelector(t.target))return;t.preventDefault(),t.stopPropagation();const e=t.clientX-this.dragData.x;this.containerEl.scrollLeft=this.dragData.left-e,e>this.minDragPositionChangePx&&this.blockClick()}}}var v=i(6);const g=i(180);class m{constructor(t,e,i){Object(n.a)(this,"allowedColumnsIdx",[]),t.dpDebugEn&&console.log("[dpit] INIT ACFTableField config:",t),this.config=t,this.jBody=$("body"),this.onFirstStepUrlChangedCb=e,this.onRowAdded=i,this.var={ajax:!1,columIds:[]},this.state={current_cell_obj:!1,cell_editor_last_keycode:!1},this.version=t.version?t.version:"1.4.0",t.dpWpLink&&(this.dpWpLink=new h.a(t.dpWpLink),this.dpWpLink.open(null,null,!0)),this.tableHtml=new b(this.config),this.jBody.on("click blur",".acf-table-body-cont--checkbox .acf-table-body-cont-sub",t=>{const e=$(t.target).closest(".acf-table-body-cont--checkbox .acf-table-body-cont-sub");if(this.state.current_cell_obj=$(e.closest(".acf-table-body-cell")[0])||!1,!e.parent(".acf-cell-eci-wrap").length){const t=this.state.current_cell_obj.find(".acf-table-cell-ec");$(e[0]).is(":checked")?t.removeClass("acf-table-cell-ec--hidden"):t.addClass("acf-table-cell-ec--hidden")}this.rebuild_table_data(e)}),$("body").on("click","#dp_wp-link-submit",t=>{if(this.state.current_cell_obj&&this.dpWpLink){const t=this.state.current_cell_obj.find(".acf-table-body-cont")[0];if(t){this.triggerChangeEventOnAcfTableRoot(t);const e=this.dpWpLink.getAttrs(),i=e.href,s=e.jSubEl,o=e.isFirstStep,n=this.state.current_cell_obj.closest(".acf-table-body-row").find(".acf-table-body-left .acf-table-body-cont").text();if(s&&s.length)s.text(i||"");else if(o){const t=this.state.current_cell_obj.find(".acf-table-body-cont").find("ul");t.length&&t.append(this.tableHtml.body_cell_link_sub_item(i))}else $(t).text(i||"");"1"==n&&(e.urlVarExamples&&$('.acf-field[data-name="url_vars_examples"] textarea').val(Object(l.C)(e.urlVarExamples,"\n")),this.onFirstStepUrlChangedCb instanceof Function&&this.onFirstStepUrlChangedCb()),this.rebuild_table_data(t)}}return t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation(),!1}),this.jBody.on("click",".acf-table-body-cont--select .acf-table-body-cont-sub",t=>{const e=$(t.target).closest(".acf-table-body-cont--select .acf-table-body-cont-sub");this.state.current_cell_obj=$(e.closest(".acf-table-body-cell")[0])||!1,this.rebuild_table_data(e)}),this.init()}triggerChangeEventOnAcfTableRoot(t){$(t).closest(".acf-field-table").trigger("change"),this.isChange=!0}init(){this.each_table(),this.table_add_row_event(),this.table_remove_row(),this.table_add_link(),this.table_remove_link(),this.simple_cell_editor(),this.link_editor(),this.tmce_cell_editor(),this.prevent_cell_links(),this.sortable_row(),this.ui_event_ajax(),this.editor_custom_style()}ui_event_ajax(){$(document).ajaxComplete(()=>{this.each_table()})}ui_init_drag_to_scroll(){this.containerDraggers={},$(".acf-table-wrap").each((t,e)=>{this.containerDraggers[e]=new f(e,".acf-table-header-cell,.acf-table-body-cell",["input","textarea",".dpit-info-icon",".dpit-table-pro-link",".acf-table-body-cell:not(.acf-table-body-cell--checkbox) .acf-table-body-cont"])})}each_table(){$(".acf-field-table .acf-table-root").not(".acf-table-rendered").each((t,e)=>{const i={};i.obj_root=$(e);i.obj_root.find(".acf-table-wrap").length>0||(i.obj_root.addClass("acf-table-rendered"),this.data_get(i),this.data_default(i),this.field_options_get(i),this.table_render(i),this.misc_render(i),void 0===i.data.b[1]&&void 0===i.data.b[0][1]&&""===i.data.b[0][0].c&&(i.obj_root.find(".acf-table-remove-col").hide(),i.obj_root.find(".acf-table-remove-row").hide()),this.containerDraggers&&this.containerDraggers[e]&&this.containerDraggers[e].refresh())})}field_options_get(t){try{t.field_options=$.parseJSON(decodeURIComponent(t.obj_root.find("[data-field-options]").data("field-options")))}catch(e){t.field_options={use_header:2},console.log("The tablefield options value is not a valid JSON string:",decodeURIComponent(t.obj_root.find("[data-field-options]").data("field-options"))),console.log("The parsing error:",e)}}data_get(t){const e=t.obj_root.find("input.table").val();if(t.data=!1,t.obj_root.closest(".acf-fields").hasClass("acf-block-fields")?t.field_context="block":t.field_context="box",""!==e){try{"box"===t.field_context&&(t.data=$.parseJSON(decodeURIComponent(e.replace(/\+/g,"%20")))),"block"===t.field_context&&(t.data=$.parseJSON(decodeURIComponent(e.replace(/\+/g,"%20"))))}catch(i){"box"===t.field_context&&(console.log("The parsing error:",i),console.log("The tablefield value is not a valid JSON string:",decodeURIComponent(e.replace(/\+/g,"%20")))),"block"===t.field_context&&(console.log("The parsing error:",i),console.log("The tablefield value is not a valid JSON string:",decodeURIComponent(e.replace(/\+/g,"%20"))))}"object"!=typeof t.data.p&&(console.log("The tablefield value is not a tablefield JSON string:",t.data),t.data=!1)}return t.data}data_default(t){if(t.data_defaults={acftf:{v:this.version},p:{o:{uh:0},ca:""},c:[{c:""}],h:[{c:""}],b:[[{c:""}]]},t.data){"array"===typeof t.data.b&&$.extend(!0,t.data,t.data_defaults)}else t.data=t.data_defaults}table_render(t){if(t.obj_root.find(".acf-table-wrap").remove(),t.obj_root.append(this.tableHtml.table),t.obj_table=t.obj_root.find(".acf-table-table"),t.obj_top_row=t.obj_root.find(".acf-table-top-row"),t.obj_top_insert=t.obj_top_row.find(".acf-table-top-right"),t.obj_header_row=t.obj_root.find(".acf-table-header-row"),t.obj_header_insert=t.obj_header_row.find(".acf-table-header-right"),t.obj_bottom_row=t.obj_root.find(".acf-table-bottom-row"),t.obj_bottom_insert=t.obj_bottom_row.find(".acf-table-bottom-right"),t.data.c)for(var e in t.data.c)t.obj_top_insert.before(this.tableHtml.top_cell);if(this.table_top_labels(t),t.data.h)for(e in t.data.h){var i;const s=t.data.h[e].v.replace(/xxx&quot/g,'"').trim();let o=t.data.h[e].c.replace(/xxx&quot/g,'"').trim();this.var.columIds.push(s);let n="";if(!Object.keys(this.config.stepDefinitions).includes(s)||null!==(i=this.config.stepDefinitions[s])&&void 0!==i&&i.hide)n="dp-hidden";else{const t=this.config.stepDefinitions[s];t&&(this.allowedColumnsIdx.push(Number(e)),o=t.title)}t.obj_header_insert.before(this.tableHtml.header_cell(o,n,s))}if(t.data.b){for(e in t.data.b)t.obj_bottom_row.before(this.tableHtml.body_row.replace("\x3c!--ph--\x3e",parseInt(e)+1));$(".acf-table-sort-row-icon").load(o()(this.config.assetsUrl,"/icons/arrows-alt-v-solid.svg")).addClass("acf-table-sort-row-icon--loaded").fadeIn(700)}const s=t.obj_root.find(".acf-table-body-row");let n=0;s&&s.each((i,s)=>{const o=$(s),a=o.find(".acf-table-body-right");for(e in t.data.b[n]){let i=t.data.b[n][e].c;i&&(i=t.data.b[n][e].c.replace(/xxx&quot/g,'"')),a.before(this.get_column_html(Number(e),i,n,o))}n+=1})}get_column_html(t,e,i,s){var o,n,a;const r=this.var.columIds[t],c=null===(o=this.config.stepDefinitions)||void 0===o?void 0:o[r],d=c?c.type:"",h=c?c.title:"";let p=[];this.allowedColumnsIdx.includes(t)||p.push("dp-hidden"),p.push("acf-table-body-cell--".concat(d));const u=p.join(" "),b=Object(l.e)(e,r,this.config.stepDefinitions,!1);switch("hidden_meta"===r&&"1"===(null==b||null===(n=b.ext)||void 0===n||null===(a=n.build_with_wp_editor)||void 0===a?void 0:a.val)&&s&&s.find(".acf-table-body-cell--text_wp_edit .acf-table-body-cont").addClass("acf-table-body-cont--wsn"),d){case"link":return this.tableHtml.body_cell_link(b.val,u,b.ext,i,h);case"select":return this.tableHtml.body_cell_select(c.options,b.val,u,h);case"checkbox":return this.tableHtml.body_cell_checkbox(!0===b.val||1==b.val,u,b.ext,h);default:return this.tableHtml.body_cell(b.val,u,b.ext,null,h)}}misc_render(t){this.init_option_use_header(t),this.init_option_caption(t)}init_option_use_header(t){const e={};e.obj_use_header=t.obj_root.find(".acf-table-fc-opt-use-header"),2===t.field_options.use_header&&(t.obj_table.addClass("acf-table-hide-header"),t.data.p.o.uh=0,this.update_table_data_field(t)),1===t.field_options.use_header&&(t.data.p.o.uh=1,this.update_table_data_field(t)),1===t.data.p.o.uh&&e.obj_use_header.val("1"),0===t.data.p.o.uh&&e.obj_use_header.val("0"),1===t.data.p.o.uh&&t.obj_table.removeClass("acf-table-hide-header"),0===t.data.p.o.uh&&t.obj_table.addClass("acf-table-hide-header")}init_option_caption(t){if("number"!=typeof t.field_options.use_caption||2===t.field_options.use_caption)return;const e={};e.obj_caption=t.obj_root.find(".acf-table-fc-opt-caption"),e.obj_caption.val(t.data.p.ca)}table_add_col(t){const e=t.obj_col.index();t.obj_root=t.obj_col.parents(".acf-table-root"),t.obj_table=t.obj_root.find(".acf-table-table"),$(t.obj_table.find(".acf-table-top-row").children()[e]).after(this.tableHtml.top_cell.replace("\x3c!--ph--\x3e","")),$(t.obj_table.find(".acf-table-header-row").children()[e]).after(this.tableHtml.header_cell("")),t.obj_table.find(".acf-table-body-row").each((t,i)=>{$($(i).children()[e]).after(this.tableHtml.body_cell())}),this.table_top_labels(t),t.obj_table.find(".acf-table-remove-col").show(),t.obj_table.find(".acf-table-remove-row").show(),this.table_build_json(t)}table_add_row_event(){this.jBody.on("mouseup",".acf-table-add-row",t=>{t.preventDefault(),t.stopPropagation();const e=$(t.target).closest(".acf-table-add-row"),i={};return i.obj_row=e.parent().parent(),this.table_add_row(i),!1})}table_add_first_row(){}table_add_row(t){var e;let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=0,n=0,a="";t.obj_root=t.obj_row.parents(".acf-table-root"),t.obj_wrap=t.obj_root.find(".acf-table-wrap"),t.obj_table=t.obj_root.find(".acf-table-table"),t.obj_table_rows=t.obj_table.children(),n=t.obj_table.find(".acf-table-top-cell").size(),s=t.obj_row.index();const l=s-1;for(let e=0;e<n;e++){let s=null;const o=this.var.columIds[e];if(o){var r;const n=null===(r=this.config.stepDefinitions)||void 0===r?void 0:r[o];var c;if(s=this.config.stepDefinitions[o]?this.config.stepDefinitions[o].def:"",n&&"link"===n.type){if(0!=l||i)a+=this.get_column_html(Number(e),i?s:s||"$keep-prev-step-url",l);else if(l+2<(null===(c=t.obj_table_rows)||void 0===c?void 0:c.length)){const t=$("#dpit-admin-first-step-link-cell").get(0);t&&(a+=t.outerHTML,t.outerHTML=this.get_column_html(Number(e),"$keep-prev-step-url",l+1))}}else a+=this.get_column_html(Number(e),s,l)}}$(t.obj_table_rows[s]).after(this.tableHtml.body_row).next().find(".acf-table-body-left").after(a),this.table_left_labels(t),t.obj_table.find(".acf-table-remove-col").show(),t.obj_table.find(".acf-table-remove-row").show(),this.table_build_json(t),null===(e=this.containerDraggers[t.obj_wrap.get(0)])||void 0===e||e.refresh(),$(".acf-table-sort-row-icon:not(.acf-table-sort-row-icon--loaded)").load(o()(this.config.assetsUrl,"/icons/arrows-alt-v-solid.svg")).addClass("acf-table-sort-row-icon--loaded").fadeIn(700),this.onRowAdded instanceof Function&&this.onRowAdded()}table_remove_first_row(t){const e=t.find(".acf-table-top-cell").size();for(let o=0;o<e;o++){const e=this.var.columIds[o];if(e){var i;const o=null===(i=this.config.stepDefinitions)||void 0===i?void 0:i[e];if(o&&"link"===o.type){const e=$("#dpit-admin-first-step-link-cell").get(0);if(e){var s;const i=null===(s=t.find(".acf-table-body-row").get(1))||void 0===s?void 0:s.querySelector(".acf-table-body-cell--link");i&&(i.outerHTML=e.outerHTML)}}}}}table_remove_row(){this.jBody.on("click",".acf-table-remove-row",t=>{t.preventDefault();const e=$(t.target).closest(".acf-table-remove-row");let i=!1;const s={};s.obj_row=e.parent().parent(),s.obj_root=e.parents(".acf-table-root"),s.obj_table=s.obj_root.find(".acf-table-table"),s.obj_rows=s.obj_root.find(".acf-table-body-row");const o=s.obj_row.index()-2;i=s.obj_rows.length,0===o&&this.table_remove_first_row(s.obj_table),e.parent().parent().remove(),s.obj_table_rows=s.obj_table.children(),1==i&&(this.table_add_row({obj_row:s.obj_table.find(".acf-table-header-row")},!0),s.obj_table.find(".acf-table-remove-row").hide()),this.table_left_labels(s),this.table_build_json(s)})}table_add_link(){this.jBody.on("click",".acf-table-add-link",t=>{t.preventDefault(),this.state.current_cell_obj=$(t.target).closest(".acf-table-body-cell--link"),this.openWpLinkModal()})}table_remove_link(){this.jBody.on("click",".acf-table-remove-link",t=>{t.preventDefault(),t.stopPropagation(),this.triggerChangeEventOnAcfTableRoot(t.target);const e={},i=$(t.target).closest(".acf-table-remove-link");e.obj_root=i.parents(".acf-table-root"),e.obj_table=e.obj_root.find(".acf-table-table"),e.obj_rows=e.obj_root.find(".acf-table-body-row"),$(t.target).closest("li").remove(),this.table_build_json(e),this.onFirstStepUrlChangedCb&&this.onFirstStepUrlChangedCb()})}table_top_labels(t){let e="A".charCodeAt(0),i="A".charCodeAt(0),s=!1;t.obj_table.find(".acf-table-top-cont").each((t,o)=>{let n="";s?(n=String.fromCharCode(e)+String.fromCharCode(i),i==="Z".charCodeAt(0)?(e+=1,i="A".charCodeAt(0)):i+=1):(n=String.fromCharCode(e),e==="Z".charCodeAt(0)?(e="A".charCodeAt(0),s=!0):e+=1),$(o).text(n)})}table_left_labels(t){let e=0;t.obj_table.find(".acf-table-body-left").each((t,i)=>{e+=1,$(i).find(".acf-table-body-cont").text(e)})}getTableBodyCellContValAtomic(t,e){var i;let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".acf-table-body-cont-sub";switch(t){case"checkbox":return null!==(i=e.find(s)[0])&&void 0!==i&&i.checked?"1":"0";case"number":case"select":return $(e.find(s)[0]).val();case"link":if(e.parent().hasClass("acf-table-body-cell--link-multi")){let t=[];const i=$(e[0]).find(".acf-table-body-cont-li");return i.length&&i.each((e,i)=>{t.push($(i).find("span").text())}),t.filter(t=>t).join(",")}return e.html();case"ext_only":return"";default:return e.clone().children(".acf-table-cell-ec").remove().end().html()}}getStepExtCfg(t){var e;return t&&this.config.stepDefinitions[t]?null===(e=this.config.stepDefinitions[t])||void 0===e?void 0:e.ext:null}getTableBodyCellContVal(t,e){var i;let s={};const o=null===(i=this.config.stepDefinitions)||void 0===i?void 0:i[t],n=this.getStepExtCfg(t);if(o){let i=this.getTableBodyCellContValAtomic(o.type,e);if(n){const s={};e.find(".acf-cell-eci-wrap").each((t,e)=>{const i=$(e).attr("data-id");if(i&&n[i]){const t=n[i].type;t&&(s[i]=this.getTableBodyCellContValAtomic(t,$(e)))}}),i=Object(l.g)({val:i,ext:s},t,this.config.stepDefinitions)}s=i}return s}table_build_json(t){let e=0,i=0;t.data=this.data_get(t),this.data_default(t),t.data.c=[],t.data.h=[],t.data.b=[],e=0,t.obj_table.find(".acf-table-top-cont").each((i,s)=>{t.data.c[e]={},t.data.c[e].p=$(s).parent().data("colparam"),e+=1}),e=0,t.obj_table.find(".acf-table-header-cont").each((i,s)=>{t.data.h[e]={},t.data.h[e].c=$(s).html(),t.data.h[e].v=$(s).data("val"),e+=1}),e=0,i=0,t.obj_table.find(".acf-table-body-row").each((s,o)=>{t.data.b[e]=[],$(o).find(".acf-table-body-cell .acf-table-body-cont").each((s,o)=>{t.data.b[e][i]={};const n=this.var.columIds[i];n&&(t.data.b[e][i].c=this.getTableBodyCellContVal(n,$(o))),i+=1}),i=0,e+=1}),this.update_table_data_field(t)}update_table_data_field(t){t.data=this.update_table_data_version(t.data);let e=JSON.stringify(t.data);e.replace(/\\"/g,'\\"'),e=encodeURIComponent(e),t.obj_root.find("input.table").val(e),this.field_changed(t)}update_table_data_version(t){return void 0===t.acftf&&(t.acftf={}),t.acftf.v=this.version,t}tmce_cell_editor(){this.tmce=new c.a(this.config.tmce,(t,e)=>{if(t){t.html(e);const i={};i.obj_root=t.parents(".acf-table-root"),i.obj_table=i.obj_root.find(".acf-table-table"),i.obj_rows=i.obj_root.find(".acf-table-body-row");const s=t.closest(".acf-table-body-row");s.find('.acf-cell-eci-wrap[data-id="build_with_wp_editor"] input').prop("checked",!0),s.find(".acf-table-body-cell--text_wp_edit .acf-table-body-cont").addClass("acf-table-body-cont--rt"),this.table_build_json(i),this.triggerChangeEventOnAcfTableRoot(t)}},!1,this.config.dpDebugEn),this.jBody.on("click",".acf-table-body-cell--text_wp_edit",t=>{let e=$(t.target).hasClass("acf-table-body-cont")?$(t.target):$(t.target).find(".acf-table-body-cont");e.length||(e=$(t.target).closest(".acf-table-body-cont")),this.tmce.open(e,e.html(),this.getStepIdx($(t.target)))})}editor_custom_style(){var t;Object(l.B)(null===(t=this.config)||void 0===t?void 0:t.text_styles,Object(v.j)())}openWpLinkModal(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(this.dpWpLink){let i=e;const s=t?this.getStepIdx(t):1,o=$('.acf-field[data-name="url_vars_examples"] textarea').val();let n=null;return o&&(n=Object(l.D)(o,"\n")),this.dpWpLink.open(i,null,!1,!0,s,Object(d.d)(),n,this.config.sysUrlVars,t),!1}}link_editor(){this.jBody.on("click",".acf-table-body-cell--link",t=>{if(this.dpWpLink){const e=$(t.target).closest(".acf-table-body-cell--link");this.state.current_cell_obj=e;let i=!0,s="",o=null;const n=e.find(".acf-table-body-cont");if(n.length){const e=$(t.target).closest(".acf-table-body-cont-li");e.length?(o=$(e[0]).find("span"),o.length&&(s=$(o[0]).text())):n.find("ul").length?i=!1:(s=$(n[0]).text(),o=$(n))}return i&&this.openWpLinkModal(o,s),!1}})}simple_cell_editor(){this.jBody.on("click",".acf-table-body-cell--text",t=>{const e=$(t.target).closest(".acf-table-body-cell--text");e.find(".acf-table-cell-editor").length>0||(t.stopImmediatePropagation(),$(t.target).closest(".acf-table-cell-ec").length||(this.cell_editor_save(),this.cell_editor_add_editor({that:e})))}),this.jBody.on("click",".acf-table-cell-editor-textarea",t=>{t.stopImmediatePropagation()}),this.jBody.on("click",()=>(this.cell_editor_save(),!0))}getStepIdx(t){return Number(t.closest(".acf-table-body-row").find(".acf-table-body-left .acf-table-body-cont").text())}cell_editor_add_editor(t){if((t=$.extend(!0,{that:!1},t)).that&&(this.state.current_cell_obj=t.that,t.that.hasClass("acf-table-body-cell--text"))){const e=t.that.find(".acf-table-body-cont, .acf-table-header-cont").html();this.state.cell_editor_is_open=!0,t.that.append(this.tableHtml.htmleditor).find(".acf-table-cell-editor-textarea").html(e).focus(),$(".acf-table-cell-editor").fadeIn(),t.that.find(".acf-table-body-cont").addClass("dpit-hidden-hard");const i=$(".acf-table-cell-editor-textarea")[0];g(i),i.focus(),i.setSelectionRange(i.value.length,i.value.length)}}get_next_table_cell(){let t=this.state.current_cell_obj.next(".acf-table-body-cell, .acf-table-header-cell");0===t.length&&(t=this.state.current_cell_obj.parent().next(".acf-table-body-row").find(".acf-table-body-cell").first()),0!==t.length?this.state.current_cell_obj=t:this.state.current_cell_obj=!1}get_prev_table_cell(){const t=this.state.current_cell_obj.closest(".acf-table-table").hasClass("acf-table-hide-header");let e=this.state.current_cell_obj.prev(".acf-table-body-cell, .acf-table-header-cell");if(0===e.length){const i=[".acf-table-body-row"];!1===t&&i.push(".acf-table-header-row"),e=this.state.current_cell_obj.parent().prev(i.join(",")).find(".acf-table-body-cell, .acf-table-header-cell").last()}0!==e.length?this.state.current_cell_obj=e:this.state.current_cell_obj=!1}rebuild_table_data(t){const e=$(t).parents(".acf-table-root"),i={obj_root:e,obj_table:e.find(".acf-table-table")};this.table_build_json(i)}cell_editor_save(){const t=this.jBody.find(".acf-table-cell-editor"),e=t.find(".acf-table-cell-editor-textarea"),i={};var s="";$(t.prev()).removeClass("dpit-hidden-hard"),void 0!==e.val()&&(i.obj_root=t.parents(".acf-table-root"),i.obj_table=i.obj_root.find(".acf-table-table"),s=(s=(s=e.val()).replace(/<(script)/gi,"&#060;$1")).replace(/<\/(script)/gi,"&#060;/$1"),t.prev().html(s),this.table_build_json(i),t.remove(),this.state.cell_editor_is_open=!1,i.obj_root.find(".acf-table-remove-col").show(),i.obj_root.find(".acf-table-remove-row").show()),$(".acf-table-cell-editor").fadeOut()}prevent_cell_links(){this.jBody.on("click",".acf-table-body-cont a, .acf-table-header-cont a:not(.dpit-table-pro-link)",t=>{t.preventDefault()})}sortable_fix_width(t,e){return e.children().each((t,e)=>{const i=$(e);i.width(i.width())}),e}fixVerticalScrollTop(t){if(t){t.closest(".acf-table-wrap").scrollTop=0}}sortable_row(){const t=this,e={axis:"y",items:"> .acf-table-body-row",containment:"parent",handle:".acf-table-body-left",helper:this.sortable_fix_width,cancel:".no-drag",update(e,i){const s={};s.obj_root=i.item.parents(".acf-table-root"),s.obj_table=s.obj_root.find(".acf-table-table"),t.table_left_labels(s),t.fixVerticalScrollTop(i.item.get(0));const o=i.item.index()-1;let n=i.item.find("#dpit-admin-first-step-link-cell").get(0);if(n||(n=$("#dpit-admin-first-step-link-cell").get(0)),n){const e=t.var.columIds.indexOf("url"),i=$(n).find(".acf-table-body-cont-li").first().find("span").text();n.outerHTML=t.get_column_html(e,i||"$keep-prev-step-url",o);const l=s.obj_table.find(".acf-table-body-row").first().find(".acf-table-body-cell--link").get(0);if(l){var a;let i=null===(a=l.querySelector(".acf-table-body-cont"))||void 0===a?void 0:a.textContent;"$keep-prev-step-url"!==i&&"$keep-current-url"!==i||(i=""),l.outerHTML=t.get_column_html(e,i,0)}t.onRowAdded instanceof Function&&t.onRowAdded()}t.table_build_json(s)}};$(".acf-table-table").sortable(e)}field_changed(t){"block"===t.field_context&&t.obj_root.change()}sort_cols(t){t.obj_table.find(".acf-table-header-row").each((e,i)=>{t.header_row=$(i),t.header_row_children=t.header_row.children(),t.end_index<t.start_index&&$(t.header_row_children[t.end_index]).before($(t.header_row_children[t.start_index])),t.end_index>t.start_index&&$(t.header_row_children[t.end_index]).after($(t.header_row_children[t.start_index]))}),t.obj_table.find(".acf-table-body-row").each((e,i)=>{t.body_row=$(i),t.body_row_children=t.body_row.children(),t.end_index<t.start_index&&$(t.body_row_children[t.end_index]).before($(t.body_row_children[t.start_index])),t.end_index>t.start_index&&$(t.body_row_children[t.end_index]).after($(t.body_row_children[t.start_index]))})}}var _=i(14),y=i(15),w=i(32),k=i(2);const C="dpit-step-table",x="dpit-step-builder-btn",E="dpit-trigger-group-",j="dpit-trigger-btn-",S="wpbody-content",T="edit-slug-box",D="dpit-admin-tour-edit-loader",A="dpit-admin-btn",B="dpit-admin-btn-wrap",I="dpit-or-set-manually",L="dpit-loader__title",U="dpit-loader",O="dpit-admin-pulse-anim",H=0,P='.acf-field-table[data-name="intro_steps"] .acf-table-table',R=".select2-selection__choice__remove",N='.acf-field[data-name="trigger_mode"]';const V="dpit-admin-btn",z="dpit-admin-btn-wrap",F="dpit-promo-btn-wrap";class M{constructor(t){t.dpDebugEn&&console.log("[dpit] INIT DPProPromoButton"),this.config=t;['.acf-field[data-name="intro_enabled"','.acf-field-group[data-name="intro_url_variables"]>.acf-label'].forEach((e,i)=>{const s=document.querySelector(e);if(s){const e=new _.a(this.onClick.bind(this),{default:t.proCTAText},"default",V,[V+"--cta",V+"--xl"]),o=Object(l.G)(e.getButtonElement(),z,F+"-"+(i+1));s.append(o)}})}onClick(t){t.button.startAnimation(!1,1,()=>{window.open(this.config.proDemoLink,"_blank")})}}class q{constructor(t){t.dpDebugEn&&console.log("[dpit] INIT DPAcfAdjust"),$(document).on("tap",".acf-icon",t=>{$(t.target).trigger("click")}),$(document).on("mousedown",'.acf-field-relationship .values-list .acf-rel-item .acf-icon[data-name="remove_item"]',t=>{console.log("mouseDown"),$(t.target).trigger("click")})}}jQuery(document).ready(t=>{window.$=t,window.dpIntroToursAdminTourEditConfig.dpDebugEn&&console.log("[dpit] INIT Admin Tour Edit Config:",window.dpIntroToursAdminTourEditConfig),new q(window.dpIntroToursAdminTourEditConfig),new M(window.dpIntroToursAdminTourEditConfig)}),new class{constructor(t){t.dpDebugEn&&console.log("[dpit] INIT "+this.printModuleName()),this.config=t,this.preInit(),this.initAcfActions()}initAcfActions(){window.acf.addAction("load",()=>{this.initSubModules(()=>{this.init()&&this.runAfterInitActions()})}),window.acf.addAction("invalid_field",()=>{this.deactivateLoader(),this.adminToolBar&&this.adminToolBar.stopPrimaryBtnAnimation()})}preInit(){this.firstStepUrl=this.config.tourStartPageUrl}init(){return this.postRootEl=document.getElementById(S),this.publishBtnOrigEl=document.getElementById("publish"),!!this.postRootEl&&(this.initTriggers(),this.initStepBuilder(),this.initAcfPageLinkLongTouch(),this.initLoader(),!0)}async runAfterInitActions(){this.renderStartUrlAndTourId(),this.renderBuilderStepsButton(),this.renderTriggerButton(H),this.startButtonsClickAbilityAutoUpdate(),this.startTriggerSelectorLabelAutoUpdate(),this.startIsChangeCheck(),this.adminToolBar.render(!1),this.actualizeToolbar(this.isReady),this.deactivateLoader();await Object(d.e)(this.config.queryParamsDefs,O,{align:{top:0,topOffset:40,lockX:!0}})||this.adminToolBar.scrollToStoredScrollTop()||$(document.documentElement).scrollTop(0),y.a.doAction("adminEditTourLoaded",{tourId:this.config.tourId})}activateLoader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:500;if(this.loaderEl){if(t){const e=this.loaderEl.querySelector("."+L);e&&(e.innerHTML=t)}i>0?setTimeout(()=>{this.loaderEl.classList.remove(U+"--inactive"),e&&this.hidePostContent()},i):(this.loaderEl.classList.remove(U+"--inactive"),e&&this.hidePostContent())}}deactivateLoader(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.loaderEl&&(this.loaderEl.classList.add(U+"--inactive"),t&&this.showPostContent())}initLoader(){this.loaderEl=document.getElementById(D)}showPostContent(){this.postRootEl&&(this.postRootEl.style.opacity=1)}hidePostContent(){this.postRootEl&&(this.postRootEl.style.opacity=0)}initSubModules(t){this.stepsTable=new m({...this.config.acfTable,i18n:this.config.i18n,stepDefinitions:this.config.stepDefinitions},this.actualize.bind(this),this.onNewTableRowAdded.bind(this)),this.acfTippy=new r(this.config,()=>{this.stepsTable.ui_init_drag_to_scroll(),t()}),this.adminToolBar=new w.b(this.config,!1,!1,this.onRedirectingFromToolbar.bind(this),!1)}onRedirectingFromToolbar(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.beforeRedirecting(),this.activateLoader(e+" ...")}onNewTableRowAdded(){this.acfTippy&&this.acfTippy.reloadInfoIcons(),this.actualize()}initTrigger(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H;const e=this.postRootEl.querySelector('.acf-field[data-name="'.concat(this.getTriggerAcfGroupName(t),'"]'));e&&(e.id=E+t,this.triggersData.push({groupEl:e}))}initStepBuilder(){this.startUrlOptionEl=this.getStartUrlOptionEl(),this.stepsTableEl=this.postRootEl.querySelector(P)}initTriggers(){this.triggersData=[],this.initTrigger(H)}initAcfPageLinkLongTouch(){$(R).on("touchstart click",t=>{const e=$(t.target).closest("li");e.length&&$(e[0]).remove()})}renderStartUrlAndTourId(){if(this.slugBoxEl=this.postRootEl.querySelector("#"+T),this.slugBoxEl){const t=this.slugBoxEl.querySelector("strong");t&&(t.innerText=this.config.i18n.permalink_title);const e=document.createElement("span");e.className="dpit-tour-id",e.innerText=this.config.i18n.tour_id+" : "+this.config.tourId,this.slugBoxEl.appendChild(e)}}actualizeAllTourStartUrlLinks(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const s=$(".updated.notice");if(t){const t=$("#wp-admin-bar-view a, .updated.notice > p > a"),o=$(this.slugBoxEl).find("#sample-permalink");if(e){const i=Object(l.w)(e,this.config.siteUrl);o.attr("href",i),t.attr("href",i)}i&&o.text(i),s.show(),$(this.slugBoxEl).show()}else s.hide(),$(this.slugBoxEl).hide()}renderBuilderStepsButton(){const t=document.querySelector('.acf-field-table[data-name="intro_steps"] .acf-label');if(t){this.builderStepsBtn=new _.a(t=>this.obBtnClick(t,k.e.STEP,C),this.getBtnState(this.config.i18n.configure_steps_visually),"default",A,["button-primary",A+"--xl"],!1,x);const e=Object(l.G)(this.builderStepsBtn.getButtonElement(),B,"",Object(d.a)(this.config.i18n.or_set_man_table,I));t.after(e)}}renderTriggerButton(t){const e=this.triggersData[t];if(e){const i=e.groupEl;if(i){const s=i.querySelector('.acf-field[data-name="intro_trigger_selector"] .acf-input');s&&(e.button=new _.a(e=>this.obBtnClick(e,k.e.TRIGGER,"dpit-trigger-selector-"+t,t),this.getBtnState(this.config.i18n.set_visually),"default",A,["button-primary",A+"--xl"],!1,j+t),e.btnWrapEl=Object(l.G)(e.button.getButtonElement(),B,"",Object(d.a)(this.config.i18n.or_set_man,I)),s.before(e.btnWrapEl))}}}obBtnClick(t,e,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;switch(t.state){case"undef-start":this.scrollToStartUrl();break;case"default":{const o=t.button;o.startAnimation(),this.adminToolBar.deactivate(),this.beforeRedirecting();const n=Object(d.c)(this.config.queryParamsDefs,this.config.tourId,e,i,k.b.ADMIN,s);if(this.isUnsavedChange)this.activateLoader(this.config.i18n.storingChanges,!0,1e3),this.setTransientAndPressPrimaryButton(n,this.config.i18n.loadingFB,()=>{o.stopAnimation()});else{this.activateLoader(this.config.i18n.loadingFB,!0,1e3);try{this.redirectToFirstStepUrl(n)}catch(t){console.error(t)}}}}}async redirectToFirstStepUrl(t){const e=await this.getFirstStepLink();if(null!=e&&e.url){const i=o()(this.config.siteUrl,e.url,t);window.location.href=i}}beforeRedirecting(){}beforeUnload(){this.isUnsavedChange||this.adminToolBar.storeCurrentScrollTop()}startIsChangeCheck(){window.addEventListener("beforeunload",this.beforeUnload.bind(this)),$(".acf-field").on("change",()=>{var t;this.isUnsavedChange=!0,null===(t=this.adminToolBar)||void 0===t||t.setIsChange()})}actualizeButtonsState(t){this.builderStepsBtn.setOnlyState(t),this.triggersData.forEach(e=>{null==e||e.button.setOnlyState(t)})}actualizeToolbar(t){t?this.adminToolBar.showButtons(w.a.preview,w.a.view):this.adminToolBar.hideButtons(w.a.preview,w.a.view)}async actualize(){var t,e;let i=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.actualizeCore(null!==(null===(t=this.triggersData[H])||void 0===t||null===(e=t.groupEl)||void 0===e?void 0:e.querySelector('.acf-field[data-name="intro_related_posts"] ul.select2-selection__rendered li:not(.select2-search--inline)')));try{if(i&&this.firstStepUrl)this.actualizeCore(null!==this.firstStepUrl,this.firstStepUrl);else{const t=await this.getFirstStepLink();this.firstStepUrl=null==t?void 0:t.url,this.firstStepUrl&&this.actualizeCore(null!==this.firstStepUrl,this.firstStepUrl)}}catch(t){console.error(t)}}actualizeCore(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.isReady=t,this.actualizeToolbar(t),this.actualizeAllTourStartUrlLinks(t),this.actualizeButtonsState(t?"default":"undef-start"),t&&e?this.actualizeAllTourStartUrlLinks(!0,e,this.getStepUrlLabel(e)):this.actualizeAllTourStartUrlLinks(!1)}actualizeTriggerSelectorLabel(t){const e=t.querySelector('.acf-field[data-name="intro_trigger_selector"]>.acf-label>label');if(e){var i;const s=null===(i=t.querySelector("input:checked"))||void 0===i?void 0:i.value;e.innerHTML="button"===s?this.config.i18n.button:this.config.i18n.element}}startButtonsClickAbilityAutoUpdate(){this.actualize(),new window.acf.Model({events:{"change .acf-field-page-link":"onChange"},onChange:()=>this.actualize(!1)})}startTriggerSelectorLabelAutoUpdate(){this.triggersData.forEach(t=>{const e=t.groupEl.querySelector(N);e&&e.addEventListener("change",()=>this.actualizeTriggerSelectorLabel(t.groupEl))})}printModuleName(){return"DpitAdminTourEdit"}getStepUrlLabel(t){return"/"===t?this.config.i18n.HOME_PAGE:t}getBtnState(t){return{default:t,"undef-start":{content:this.config.i18n.set_first_step_url_FREE,activeMod:"undef"}}}async getFirstStepLink(){const t=this.getAcfFieldVal("intro_related_posts");if(t){const e=t[0],i=await this.postAjaxData("get-permalink",{id:e});return{url:i,label:i}}return null}getAcfFieldVal(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const i=window.acf.getFields({name:t});return i?i[0].val():e}async setTransientAndPressPrimaryButton(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{await this.ajaxSetTransient("dpit_builder_transient",t,this.config.tourId,30),this.activateLoader(e,!0,1e3),this.pressPrimaryButton(),i instanceof Function&&i(!0)}catch(t){console.error(t,null==t?void 0:t.stack),i instanceof Function&&i(!1)}}getStartUrlOptionEl(){return this.postRootEl.querySelector('.acf-field[data-name="intro_trigger"] .acf-field[data-name="intro_related_posts"]')}async scrollToStartUrl(){return await Object(l.y)(this.startUrlOptionEl)}postAjaxData(t,e){return $.ajax({url:o()(this.config.restApiUrl,"dpintrotours/v1/",t),type:"post",data:e,headers:{"X-WP-Nonce":this.config.nonces.wp_rest}})}async ajaxSetTransient(t,e,i,s){return await this.postAjaxData("set-transient",{name:t,expirationS:s,transientData:{postId:i,redirectQueryString:e,isGlobalStartAtAllPagesSet:this.isGlobalStartAtAllPagesSet()?1:0}})}pressPrimaryButton(){$(this.publishBtnOrigEl).trigger("click")}getTriggerAcfGroupName(t){return t===H?"intro_trigger":"intro_trigger_2"}isGlobalStartAtAllPagesSet(){return $('.acf-field[data-name="global_start_at_all_pages"] .acf-switch').hasClass("-on")}}(window.dpIntroToursAdminTourEditConfig)},19:function(t,e,i){"use strict";i.d(e,"e",(function(){return n})),i.d(e,"c",(function(){return a})),i.d(e,"d",(function(){return l})),i.d(e,"b",(function(){return r})),i.d(e,"a",(function(){return c}));var s=i(4),o=i(2);const n=async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"dpit-admin-pulse-anim",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{align:{top:.5,left:.5}},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"dp_qpb_origin_el_id",n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"dp_qpb_canceled",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";const l=new URL(window.location);let r=Object(s.m)(o,t,l);if(r){const o=document.getElementById(r);if(o){if("1"===Object(s.m)(n,t,l))return Object(s.x)(o,i);Object(s.y)(o,e,1e3,i,!0,"",a),Promise.resolve(!0)}return Promise.resolve(!1)}return Promise.resolve(!1)},a=function(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.e.STEP,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:o.b.ADMIN,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;const r={dp_qpb_builder_mode:i,dp_qpb_builder_origin:a,dp_qpb_origin_el_id:n,dp_qp_tour_id:e,dp_qp_run_always_on_load:"1",dp_qp_trigger_id:l};return Object(s.c)(r,t,"?")},l=()=>$('.acf-field[data-name="url_vars_enabled"] .acf-switch').hasClass("-on"),r=()=>{let t=0;return $(".notice:visible").each((function(){t+=$(this).outerHeight(!0)})),t},c=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const i=document.createElement("div");return i.className=e,i.innerText="~ "+t+" ~",i}},23:function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var s=i(5),o=i.n(s);class n{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:70,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:15,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:4,r=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"",d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"dpit-on";this.rootSelectorOrElement=t,this.bemRoot="dpit-anim-rb",this.additionalClasses=o()([e,"dpit-anim-rb"]),this.inactiveClass=n.getModifiedClass(this.bemRoot,"off"),this.activeClass=d,this.id=c,this.visibleSize=a,this.totalSize=s,this.tickMs=i,this.activeSize=l,this.activeHalfSize=Math.floor(l/2),this.symmetrical=r}getRootElement(){return this.rootSelectorOrElement instanceof HTMLElement?this.rootSelectorOrElement:document.querySelector(this.rootSelectorOrElement)}static getModifiedClass(t,e){let i="";return t&&(i=t+"--"),i+=e,i}start(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.backward=t,this.rootElement=this.getRootElement(),this.rootElement&&(this.rootElement.focus({preventScroll:!0}),this.isRunning=!0,this.bulletsLayer?this.bulletsLayer.classList.remove(this.inactiveClass):this.createBullets(this.visibleSize,this.rootElement),t?this.startReloadingSpinnerBack(e,i):this.startReloadingSpinner(e,i))}getLoopTimeMs(){return this.totalSize*this.tickMs}createBullets(t,e){this.bulletsLayer=document.createElement("div"),this.bulletsLayer.className=o()([this.bemRoot,this.additionalClasses]),this.bulletsLayer.setAttribute("aria-hidden","true"),this.bulletsLayer.id=this.id,this.bulletsLayer.style.opacity=0,this.bulletsLayer.style.display="block",this.bulletElements=[];const i=document.createElement("div");i.classList.add(this.bemRoot+"__wrap");for(let e=0;e<t;e++){const t=document.createElement("div");this.bulletElements.push(t),i.appendChild(t)}this.bulletsLayer.appendChild(i),this.bulletsLayer.style.opacity=1,e.appendChild(this.bulletsLayer)}activateBullet(t){this.bulletElements.forEach((e,i)=>{let s="";const o=t-i;if(0===o)s=this.activeClass;else{const t=Math.abs(o);this.symmetrical?t<=this.activeHalfSize&&(s=this.activeClass+"--"+t):t<this.activeSize&&(o>0&&!this.backward||o<0&&this.backward)&&(s=this.activeClass+"--"+t)}e.className=s})}stopAfterLoopEnd(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.finishAfterLoopEnd=!0,this.finishAfterLoopEndCallback=t}stop(){var t,e;null===(t=this.bulletsLayer)||void 0===t||t.classList.add(this.inactiveClass),this.clearBulletActiveStates(),this.stopReloadSpinner(),null===(e=this.rootElement)||void 0===e||e.blur()}clearBulletActiveStates(){var t;null===(t=this.bulletElements)||void 0===t||t.forEach(t=>{t.className=""})}stopReloadSpinner(){this.spinnerInterval&&clearInterval(this.spinnerInterval),this.spinnerInterval=null,this.isRunning=!1}startReloadingSpinner(t,e){let i=this.symmetrical?-this.activeHalfSize:0;this.spinnerInterval&&clearInterval(this.spinnerInterval),this.bulletHideTimeout&&clearTimeout(this.bulletHideTimeout),this.spinnerInterval=setInterval(()=>{this.activateBullet(i,i-1),i++,i>this.totalSize&&(i=this.symmetrical?-this.activeHalfSize:0,this.checkAfterLoopEnd(),t>0&&(t=this.finishLoop(t,e)))},this.tickMs)}startReloadingSpinnerBack(t,e){this.spinnerInterval&&clearInterval(this.spinnerInterval),this.bulletHideTimeout&&clearTimeout(this.bulletHideTimeout);let i=this.symmetrical?this.visibleSize+this.activeHalfSize:this.visibleSize;this.spinnerInterval=setInterval(()=>{this.activateBullet(i),i--,i<this.visibleSize-this.totalSize&&(i=this.symmetrical?this.visibleSize+this.activeHalfSize:this.visibleSize,this.checkAfterLoopEnd(),t>0&&(t=this.finishLoop(t,e)))},this.tickMs)}checkAfterLoopEnd(){this.finishAfterLoopEnd&&(this.finishAfterLoopEnd=!1,this.stop(),this.finishAfterLoopEndCallback instanceof Function&&this.finishAfterLoopEndCallback(),this.finishAfterLoopEndCallback=null)}finishLoop(t,e){return t>0&&0===--t&&(this.stop(),e&&e instanceof Function&&e()),t}}},32:function(t,e,i){"use strict";i.d(e,"a",(function(){return g})),i.d(e,"b",(function(){return m}));var s=i(5),o=i.n(s),n=i(14),a=i(19),l=i(4),r=i(1);const c="dpit-tool-bar",d="dpit-admin-btn",h="dpit-tool-bar__item",p="button-primary",u="button-secondary",b="dpit-tool-bar",f="wp-admin-bar-top-secondary",v="wpadminbar",g={primary:"primary",draft:"draft",view:"view",preview:"preview"};class m{constructor(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;t.dpDebugEn&&console.log("[dpit] INIT DpitAdminToolbar"),window.wpCookies=window.wpCookies||{},this.config=t,this.config.previewButtonEnabled=i,this.onRedirectBtnClick=s,this.init(t),o&&this.scrollToStoredScrollTop(n),e&&this.render()}init(){this.adminBarEl=document.getElementById(v),this.adminBarEl&&(this.insertAfterEl=this.adminBarEl.querySelector("#"+f),this.initStopWhenInvalidFormSubmitted()),this.buttons={}}initStopWhenInvalidFormSubmitted(){$("#wpbody-content input").on("invalid",()=>{this.stopPrimaryBtnAnimation()})}setIsChange(){this.isUnsavedChange=!0}activate(){this.wrapEl.classList.remove(c+"--inactive")}deactivate(){this.wrapEl.classList.add(c+"--inactive")}stopPrimaryBtnAnimation(){this.primaryBtn&&this.primaryBtn.stopAnimation()}hideButtons(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];e&&e.forEach(t=>{var e,i;null!==(e=this.buttons[t])&&void 0!==e&&e.element&&(null===(i=this.buttons[t])||void 0===i||i.element.classList.add(h+"--inactive"))})}showButtons(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];e&&e.forEach(t=>{var e,i;null!==(e=this.buttons[t])&&void 0!==e&&e.element&&(null===(i=this.buttons[t])||void 0===i||i.element.classList.remove(h+"--inactive"))})}showOnlyButton(t){Object.keys(this.buttons).forEach(e=>{var i;e!==t&&null!==(i=this.buttons[e])&&void 0!==i&&i.element&&this.buttons[e].element.classList.add(h+"--inactive")})}render(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];!this.wrapEl&&this.insertAfterEl&&(this.wrapEl=document.createElement("div"),this.wrapEl.id=b,this.wrapEl.className=o()([c,"ab-top-secondary ab-top-menu"]),this.renderButtons(this.wrapEl),this.insertAfterEl.after(this.wrapEl),t?addEventListener("load",this.activate.bind(this)):setTimeout(()=>{this.activate()},100))}propagateButtonClick(t){var e;null!==(e=this.buttons[t])&&void 0!==e&&e.sourceEl&&this.buttons[t].sourceEl.click()}getToolbarItemModifiedClass(t){return h+"--"+t}storeButtonData(t,e,i){this.buttons[t]={element:i,sourceEl:e}}animateAndPropagateClick(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";e&&e.startAnimation(),this.showOnlyButton(t),this.storeCurrentScrollTop(),this.onRedirectBtnClick&&this.onRedirectBtnClick(t,i),r.ANIM_DBG||this.propagateButtonClick(t)}checkUnsavedAnimateAndRedirectPropagateClick(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this.isUnsavedChange?(this.storeCurrentScrollTop(),this.propagateButtonClick(t)):this.animateAndPropagateClick(t,e,i)}renderButtons(t){const e=document.querySelector('#wpbody-content .wrap input[type="submit"].button-primary:not(.find-box input, .widget-control-save, #screen-options-wrap input, #bulk_edit)');e&&(this.primaryBtn=new n.a(t=>this.animateAndPropagateClick(g.primary,null==t?void 0:t.button,this.config.i18n.storingChanges),{default:e.value},"default",d,[h,p]),this.primaryBtn&&this.storeButtonData(g.primary,e,this.primaryBtn.element));const i=$('#wpbody-content .wrap input[type="submit"]#save-post:visible:not(.find-box input)').get(0);if(i&&(this.draftBtn=new n.a(t=>this.animateAndPropagateClick(g.draft,null==t?void 0:t.button,this.config.i18n.storingChanges),{default:i.value},"default",d,[h,u]),this.draftBtn&&this.storeButtonData(g.draft,i,this.draftBtn.element)),this.config.previewButtonEnabled){const t=document.getElementById("post-preview");if(t){let e="";for(var s=0;s<t.childNodes.length;++s)t.childNodes[s].nodeType===Node.TEXT_NODE&&(e+=t.childNodes[s].textContent);this.previewBtn=new n.a(()=>this.propagateButtonClick(g.preview),{default:e},"default",d,[h,u]),this.previewBtn&&this.storeButtonData(g.preview,t,this.previewBtn.element)}}const o=document.querySelector("#wp-admin-bar-view a");o&&(this.viewBtn=new n.a(t=>this.checkUnsavedAnimateAndRedirectPropagateClick(g.view,null==t?void 0:t.button,this.config.i18n.redirecting),{default:o.textContent},"default",d,[h,u]),this.viewBtn&&this.storeButtonData(g.view,o,this.viewBtn.element)),Object.keys(this.buttons).forEach(e=>{this.buttons[e]&&t.appendChild(this.buttons[e].element)})}clearCurrentScrollTopCookie(){Object(l.f)("dpit-admin-edit-st")}storeCurrentScrollTop(){Object(l.z)("dpit-admin-edit-st",document.documentElement.scrollTop-Object(a.b)(),60),console.log("storeCurrentScrollTop")}scrollToStoredScrollTop(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const e=Object(l.j)("dpit-admin-edit-st");if(e){let i=parseInt(e,10);if(!isNaN(i))return i+=Object(a.b)(),t>0?$(document.documentElement).animate({scrollTop:i},t):$(document.documentElement).scrollTop(i),!0;this.clearCurrentScrollTopCookie()}return!1}}},48:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var s=i(12),o=i(4);const n=".mce-inline-toolbar-grp, .mce-floatpanel, #mce-modal-block, #wp-link-backdrop, #wp-link-wrap, #__wp-uploader-id-2, #mla-terms-search-overlay";class a{constructor(t,e,i,s){this.config=t,this.onTmceCancel=i,s&&console.log("[dpit] INIT DpTinyMceDialog"),$("#dp-step-content-edit .button-primary").on("click",()=>{if(e){$("#dp-tmce-editor-tmce").trigger("click");let t=window.tinyMCE.activeEditor.getContent();t=this.forceTargetBlank(t),t=t.replace(/<a(?! target="_blank")/g,'<a target="_blank"'),e(this.target,t),this.close(!1)}else this.close(!1)}),$("#dpit-mce-dialog-close, #dp-step-content-edit__backdrop").on("click",()=>{this.close()}),document.addEventListener("keydown",this.keydown.bind(this))}forceTargetBlank(t){return t}containsShortCode(t){if(!t)return!1;const e=t.match(/\[[^[]*[^\]]*\]/gi);return!!e&&e.length>0}keydown(t){this.modalOpened&&27===t.keyCode&&this.close()}showOverlay(){$("#dp-step-content-edit__backdrop").addClass("dpit-active")}hideOverlay(){$("#dp-step-content-edit__backdrop").removeClass("dpit-active")}open(t,e,i){if(this.modalOpened=!0,!1!==i&&!isNaN(i)){const t=Object(o.o)(i);$("#dp-step-content-edit .dpit-modal__title").html(this.config.title.replace("%s",t))}$("#dp-step-content-edit").addClass("dpit-active"),this.showOverlay(),this.hadDpitRelPos=$("body").hasClass("dpit-relative-position"),this.hadDpitRelPos&&$("body").removeClass("dpit-relative-position"),Object(o.F)("--dpit-scroll-top",(document.documentElement.scrollTop||document.body.scrollTop)+"px"),$("body").addClass("dpit-no-scroll"),this.target=t,$("#dp-tmce-editor-tmce").trigger("click"),this.editor=window.tinyMCE.get("dp-tmce-editor"),this.editor.setContent(null!=e?e:"",{format:"html"}),this.editor.selection&&(this.editor.selection.select(this.editor.getBody(),!0),this.editor.selection.collapse(!1)),this.enableMceFloatPanels(),this.editor.focus()}enableMceFloatPanels(){$(n).each((t,e)=>{Object(s.b)(e)})}disableMceFloatPanels(){$(n).each((t,e)=>{Object(s.a)(e)})}close(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.target=null,this.modalOpened=!1,this.disableMceFloatPanels(),$("#dp-step-content-edit").removeClass("dpit-active"),this.hideOverlay(),$("body").removeClass("dpit-no-scroll"),t&&this.onTmceCancel&&this.onTmceCancel(),this.hadDpitRelPos&&$("body").addClass("dpit-relative-position")}}},49:function(t,e,i){"use strict";i.d(e,"a",(function(){return p}));var s=i(3),o=i(5),n=i.n(o),a=i(21),l=(i(43),i(9)),r=i.n(l),c=(i(44),i(57),i(45),i(4));class d{constructor(t,e){e.dpDebugEn&&console.log("[dpit] INIT DpWpLinkQuery"),this.config=e,this.page=1,this.allLoaded=!1,this.querying=!1,this.search=t,this.init()}init(){$.extend(d.prototype,{ready(){return!(this.querying||this.allLoaded)},ajax(t){const e=this,i={action:"dp-wp-link-ajax",page:this.page,_dp_wplink_nonce:this.config._dp_wplink_nonce};this.search&&(i.search=this.search),this.querying=!0,$.post(this.config.ajaxUrl,i,s=>{e.page++,e.querying=!1,e.allLoaded=!s,t(s,i)},"json")}})}}class h{constructor(t,e){Object(s.a)(this,"timeToTriggerRiver",150),Object(s.a)(this,"minRiverAJAXDuration",200),Object(s.a)(this,"riverBottomThreshold",5),Object(s.a)(this,"posts",{}),e.config.dpDebugEn&&console.log("[dpit] INIT DpWpLinkRiver"),this.dpWpLink=e,this.config=e.config,this.element=t,this.ul=t.children("ul"),this.contentHeight=t.children("#dp_link-selector-height"),this.waiting=t.find(".river-waiting"),this.init()}delayedCallback(t,e){let i,s,o,n;return e?(setTimeout(()=>{if(s)return t.apply(n,o);i=!0},e),function(){if(i)return t.apply(this,arguments);o=arguments,n=this,s=!0}):t}init(){$.extend(h.prototype,{posts:{},refresh(){this.deselect(),this.visible=this.element.is(":visible")},show(){this.visible||(this.deselect(),this.element.show(),this.visible=!0)},hide(){this.element.hide(),this.visible=!1},select(t,e){let i,s,o,n;t.hasClass("unselectable")||t==this.selected||(this.deselect(),this.selected=t.addClass("selected"),i=t.outerHeight(),s=this.element.height(),o=t.position().top,n=this.element.scrollTop(),o<0?this.element.scrollTop(n+o):o+i>s&&this.element.scrollTop(n+o-s+i),this.element.trigger("river-select",[t,e,this]))},deselect(){this.selected&&this.selected.removeClass("selected"),this.selected=!1},prev(){if(!this.visible)return;let t;this.selected&&(t=this.selected.prev("li"),t.length&&this.select(t))},next(){if(!this.visible)return;const t=this.selected?this.selected.next("li"):$("li:not(.unselectable):first",this.element);t.length&&this.select(t)},ajax(t){const e=this,i=this.query&&1==this.query.page?0:this.minRiverAJAXDuration,s=this.dpWpLink.inputs.search.parent().find(".spinner").addClass("is-active"),o=this.delayedCallback((i,o)=>{e.process(i,o),s.removeClass("is-active"),t&&t(i,o)},i);this.query&&this.query.ajax(o)},change(t){this.query&&this._search==t||(this.posts={},this._search=t,this.query=new d(t,this.config),this.element.scrollTop(0))},process(t,e){let i="",s=!0;const o=1==e.page;if(t){const e=this.dpWpLink.isFirstStep?"dpit-special-link dpit-special-link--hidden":"dpit-special-link";i+=this.printPostTypeItem({title:this.config.keepPreviousStepUrl,permalink:"$keep-prev-step-url",info:this.config.variableLink,infoLong:this.config.keepPreviousStepUrlLngInfo},!0,e),i+=this.printPostTypeItem({title:this.config.keepCurrentUrl,permalink:"$keep-current-url",info:this.config.variableLink,infoLong:this.config.keepCurrentUrlLngInfo},!0,e);const o={},n=this.config.allowedPostTypesInPagePostURL,a=n.includes("all_post_types");$.each(t,(function(){if(this.info){let t=this.info.toLowerCase();!isNaN(parseInt(t[0]))&&(t="post");(n.includes(t)||a)&&(o[t]||(o[t]=[]),o[t].push(this))}})),Object.keys(o).forEach(t=>{this.posts[t]?this.posts[t]=[...o[t],...this.posts[t]]:this.posts[t]=o[t]}),n.forEach(t=>{"all_post_types"!==t?this.posts[t]&&this.posts[t].forEach(t=>{i+=this.printPostTypeItem(t,s),s=!s}):Object.keys(this.posts).forEach(t=>{n.includes(t)||this.config.disabledPostTypes.includes(t)||this.posts[t].forEach(t=>{i+=this.printPostTypeItem(t,s),s=!s})})}),this.ul.html(i)}else o?(i+='<li class="unselectable no-matches-found"><span class="item-title"><em>'.concat(this.config.noMatchesFound,"</em></span></li>"),this.ul.html(i)):this.ul.append(i)},printPostTypeItem(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s="",o=[];e&&o.push("alternate"),i&&o.push(i),t.title||o.push("no-title");let n=t.permalink;if(this.config.siteUrl&&!n.startsWith(this.config.siteUrl)){const t=new URL(this.config.siteUrl);t.port="";const e=t.toString().replace(/^\/+|\/+$/g,"");n.startsWith(e)&&(n=n.replace(e,this.config.siteUrl))}return o=o.join(" "),s+=o?'<li class="'.concat(o,'">'):"<li>",s+='<input type="hidden" class="item-permalink" value="'.concat(n,'" />'),s+='<span class="item-title">',s+=t.title?t.title:this.config.noTitle,s+="</span>",s+='<span class="item-info">'.concat(t.info,"</span>"),t.infoLong&&(s+='<div class="item-long-info">'.concat(t.infoLong,"</div>")),s+="</li>",s},maybeLoad(){const t=this,e=this.element,i=e.scrollTop()+e.height();!this.query.ready()||i<this.contentHeight.height()-this.riverBottomThreshold||setTimeout(()=>{const i=e.scrollTop(),s=i+e.height();!t.query.ready()||s<t.contentHeight.height()-this.riverBottomThreshold||(t.waiting.addClass("is-active"),e.scrollTop(i+t.waiting.outerHeight()),t.ajax(()=>{t.waiting.removeClass("is-active")}))},this.timeToTriggerRiver)}}),this.refresh(),$("#dp_wp-link .query-results, #dp_wp-link #dp_link-selector").scroll(this.maybeLoad.bind(this)),this.element.on("click","li",t=>{this.select($(t.target).closest("li"),t)}),this.change("")}}class p{constructor(t){Object(s.a)(this,"keySensitivity",200),Object(s.a)(this,"lastSearch",""),Object(s.a)(this,"modalOpen",!1),Object(s.a)(this,"startScrollTop",0),Object(s.a)(this,"inputs",{}),Object(s.a)(this,"rivers",{}),Object(s.a)(this,"onUrlVarClick",t=>{let e="";if(e=t.target&&"span"===t.target.tagName.toLowerCase()?$(t.target).text():$(t.target).find("span").text(),e){const t=this.inputs.url.val();let i=-1;for(let e=t.length-1;e>=0&&"}"!==t.charAt(e);e--)if("{"===t.charAt(e)){i=e;break}i>=0?this.inputs.url.val(t.slice(0,i)+e):this.inputs.url.val(t+e),this.inputs.url.focus()}}),Object(s.a)(this,"next",()=>{this.rivers.search.next(),this.rivers.recent.next()}),Object(s.a)(this,"prev",()=>{this.rivers.search.prev(),this.rivers.recent.prev()}),t.dpDebugEn&&console.log("[dpit] INIT DpWpLink"),this.config=t,this.unifiedSiteUrl=Object(c.E)(t.siteUrl,!0,!0,!0,!0),this.init()}init(){this.inputs.wrap=$("#dp_wp-link-wrap"),this.inputs.dialog=$("#dp_wp-link"),this.inputs.backdrop=$("#dp_wp-link-backdrop"),this.inputs.submit=$("#dp_wp-link-submit"),this.urlVarButton=$("#dpit-url-var-btn"),this.urlVarBackButton=$("#dpit-url-var-back-btn"),this.inputs.text=$("#wp-link-text"),this.inputs.url=$("#dp_wp-link-url"),this.inputs.nonce=$("#_ajax_linking_nonce"),this.inputs.search=$("#dp_wp-link-search"),this.inputs.search.focus(),this.rivers.search=new h($("#dp_search-results"),this),this.rivers.recent=new h($("#dp_most-recent-results"),this),this.rivers.elements=this.inputs.dialog.find(".query-results"),this.inputs.queryNotice=$("#query-notice-message"),this.inputs.queryNoticeTextDefault=this.inputs.queryNotice.find(".query-notice-default"),this.inputs.queryNoticeTextHint=this.inputs.queryNotice.find(".query-notice-hint"),this.inputs.dialog.keydown(this.keydown.bind(this)),this.inputs.dialog.keyup(this.keyup.bind(this)),this.inputs.submit.click(t=>{t.preventDefault(),this.update()}),this.inputs.backdrop.add("#dpit-wp-link-cancel").click(t=>{t.preventDefault(),this.close()}),this.rivers.elements.on("river-select",this.updateFields.bind(this)),this.inputs.search.on("focus.this",()=>{this.inputs.queryNoticeTextDefault.hide(),this.inputs.queryNoticeTextHint.removeClass("screen-reader-text").show()}).on("blur.this",()=>{this.inputs.queryNoticeTextDefault.show(),this.inputs.queryNoticeTextHint.addClass("screen-reader-text").hide()}),this.inputs.search.on("keyup input",()=>{window.clearTimeout(this.searchTimer),this.searchTimer=window.setTimeout(()=>{this.searchInternalLinks()},500)}),this.inputs.url.on("input",()=>{this.updateAfterUrlChanged(!0)}),this.inputs.url.on("paste",()=>{setTimeout(this.correctURL.bind(this),0)}),this.inputs.url.on("blur",()=>{this.correctURL(!1)}),!0===this.config.loadTippy&&($(".dpit-info-icon").load(r()(this.config.assetsUrl,"icons/info-circle-solid.svg")),$(".dpit-info-icon").each((t,e)=>{const i=$(e).hasClass("dpit-info-icon--ia"),s=$(e).hasClass("dpit-info-icon--modal")?"light-border":"material";Object(a.b)(e,{content:t=>t.getAttribute("data-info-text"),animation:"scale",theme:s,allowHTML:!0,interactive:i,zIndex:100000003})})),this.inputs.url.on("blur",()=>{this.correctURL(!1)}),this.urlVarButton.on("click",()=>{this.correctURL(!1);const t=this.inputs.url.val();this.isVariableTypingInProcess(t)||(this.inputs.url.val(t+"{"),this.updateVariableUrlsGUI(!1),this.inputs.url.focus())}),this.urlVarBackButton.on("click",()=>{this.cancelVariableTypingInProcess(),this.updateVariableUrlsGUI(!1)}),this.updateAfterUrlChanged()}sanitizeUrl(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t.startsWith("$")){let i=/^\/+|\/+$/g;e||(i=/^\/+/g),t.startsWith("/")&&(t="/".concat(t.replace(i,"")));const s=/^((http|https|ftp):\/\/)/.test(t)||t.startsWith("www.");if(s&&!Object(c.q)(t,this.config.siteUrl))return t;(t=Object(c.E)(t,!1,!0,e,!0)).startsWith(this.unifiedSiteUrl)?(t=t.replace(this.unifiedSiteUrl,""))||(t="/"):s||(t="/".concat(t.replace(i,"")))}return t}activateSubmitButtonSpinner(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0]?($("#dp_wp-link-update .spinner").addClass("is-active"),$(".dp_wp-link-wrap").addClass("no-pointer-events"),$("#dp_wp-link-update #dp_wp-link-submit").addClass("spinner-bg")):($("#dp_wp-link-update .spinner").removeClass("is-active"),$("#dp_wp-link-update #dp_wp-link-submit").removeClass("spinner-bg"),$(".dp_wp-link-wrap").removeClass("no-pointer-events"))}correctURL(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=$.trim(this.inputs.url.val());if(e){const i=this.sanitizeUrl(e,t);this.inputs.url.val(i),this.correctedURL=i}this.updateAfterUrlChanged()}showOverlay(){this.inputs.backdrop.addClass("dpit-active")}hideOverlay(){this.inputs.backdrop.removeClass("dpit-active")}open(t,e){var i,s,o,n,a,l;let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],d=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],h=arguments.length>4&&void 0!==arguments[4]&&arguments[4],p=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,b=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,f=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;if(this.closeAfterSubmit=d,this.isFirstStep=1===h,this.enableUrlVarExamples=p,this.sysUrlVars=b,this.jSubEl=f,!1!==h&&!isNaN(h)){let t=Object(c.o)(h);$("#dpit-wp-link-title").html(this.config.title.replace("%s",t))}var v;(this.startScrollTop=null!==(i=null!==(s=null===(o=document)||void 0===o||null===(n=o.documentElement)||void 0===n?void 0:n.scrollTop)&&void 0!==s?s:null===(a=document)||void 0===a||null===(l=a.body)||void 0===l?void 0:l.scrollTop)&&void 0!==i?i:0,this.modalOpen=!0,r)?(this.inputs.wrap.removeClass("dpit-active"),this.hideOverlay()):(this.inputs.wrap.addClass("dpit-active"),this.showOverlay(),Object(c.F)("--dpit-scroll-top",-(null===(v=$("body #wpbody-content").offset())||void 0===v?void 0:v.top)+"px"),$("body").addClass("dpit-no-scroll"));if(!this.isFirstStep&&(this.urlVars={},u)){var g=b||{};Object.keys(u).forEach(t=>{t in g||(this.urlVars[t]=u[t])})}this.refresh(t,e),u&&this.setUrlExamples(u),this.isFirstStep?($(".dpit-special-link").addClass("dpit-special-link--hidden"),$("#dpwplink-url-vars-1st-step").show(),$("#dpwplink-url-vars-other-step").hide()):($(".dpit-special-link").removeClass("dpit-special-link--hidden"),$("#dpwplink-url-vars-1st-step").hide(),$("#dpwplink-url-vars-other-step").show()),$(document).trigger("wplink-open",this.inputs.wrap)}refresh(t,e){this.rivers.search.refresh(),this.rivers.recent.refresh(),this.inputs.wrap.hasClass("has-text-field")||this.inputs.wrap.addClass("has-text-field"),this.inputs.text.val(e),this.setDefaultValues(),t&&this.inputs.url.val(t),window.setTimeout(()=>{this.inputs.search&&this.inputs.search.length&&(this.inputs.search[0].select(),this.inputs.search.focus())}),this.rivers.recent.ul.children().length||this.rivers.recent.ajax();var i=this.inputs.url.val();this.correctedURL=i?this.inputs.url.val().replace(/^http:\/\//,""):"",this.updateAfterUrlChanged()}close(){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])||this.closeAfterSubmit||t)&&(this.activateSubmitButtonSpinner(!1),document.documentElement.scrollTop=this.startScrollTop,$("body").removeClass("dpit-no-scroll"),this.modalOpen=!1,this.inputs.backdrop.removeClass("dpit-active"),this.inputs.wrap.removeClass("dpit-active"),this.correctedURL=!1,$(document).trigger("wplink-close",this.inputs.wrap))}getAttrs(){return this.correctURL(!0),{href:$.trim(this.inputs.url.val()),urlVarExamples:this.getUrlExamples(),jSubEl:this.jSubEl,isFirstStep:this.isFirstStep}}update(){this.htmlUpdate()}htmlUpdate(){let t;t=this.getAttrs();const e=document.createElement("a");e.href=t.href,"javascript:"!==e.protocol&&"data:"!==e.protocol||(t.href=""),t.href&&this.close(!0)}updateSubmitButton(){this.inputs.url.val()?$("#dp_wp-link-submit").removeClass("disabled"):$("#dp_wp-link-submit").addClass("disabled")}updateVariableUrlsGUI(t){const e=this.inputs.url.val();if(this.isVariableTypingInProcess(e)?(this.urlVarButton.hide(),this.urlVarBackButton.show()):(this.urlVarButton.show(),this.urlVarBackButton.hide()),this.isVariableUrl(e,!0)&&this.enableUrlVarExamples)$("#search-panel,#wplink-link-existing-content").addClass("dpwplink-inactive-el"),$("#dpwplink-url-vars-wrap").removeClass("dpwplink-inactive-el"),t?(this.renderUrlVarExTimeout&&clearTimeout(this.renderUrlVarExTimeout),this.renderUrlVarExTimeout=setTimeout(()=>{this.renderUrlVarItems(e,this.isFirstStep)},10)):this.renderUrlVarItems(e,this.isFirstStep);else{if(this.isFirstStep&&this.isVariableUrl(e)){this.nonActiveUrlVarExamples={};const t=this.getUrlVarIdsFromUrl(e);t&&t.length&&t.forEach(t=>{this.nonActiveUrlVarExamples[t]=""})}$("#dpwplink-url-vars-wrap").addClass("dpwplink-inactive-el"),$("#search-panel,#wplink-link-existing-content").removeClass("dpwplink-inactive-el")}}getUrlVarIdsFromUrl(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const i=/\{([^}]+)\}/g,s=[];let o=i.exec(t);for(;null!=o;)s.push(o[1]),o=i.exec(t);let n=s.filter((t,e,i)=>i.indexOf(t)===e);return e&&this.sysUrlVars&&(n=n.filter(t=>!Object.keys(this.sysUrlVars).includes(t))),n}renderUrlVarItems(t,e){let i=this.urlVars?Object.keys(this.urlVars):[];e?(i=this.getUrlVarIdsFromUrl(t)||[],$("#dpwplink-url-vars-hint-next-steps").hide(),i.length?($("#dpwplink-url-vars-hint-1st-step").hide(),$("#dpwplink-url-vars-hint-1st-step-fill").show()):($("#dpwplink-url-vars-hint-1st-step").show(),$("#dpwplink-url-vars-hint-1st-step-fill").hide())):($("#dpwplink-url-vars-hint-1st-step").hide(),$("#dpwplink-url-vars-hint-1st-step-fill").hide(),i.length?$("#dpwplink-url-vars-hint-next-steps").hide():$("#dpwplink-url-vars-hint-next-steps").show());let s=0;if(this.sysUrlVars&&Object.keys(this.sysUrlVars).forEach(t=>{i.unshift(t),s++}),i){$(".dpwplink-url-vars__item--id-only").off("click",this.onUrlVarClick),i.forEach((t,i)=>{const o=i<s,n=e&&!o,a=$('.dpwplink-url-vars__item[data-idx="'.concat(i,'"]'));a.length?(a.find("span").text("{".concat(t,"}")),a.attr("data-var-id",t),a.removeClass("dpwplink-url-vars__item--inactive").show(),n?a.removeClass("dpwplink-url-vars__item--id-only"):a.addClass("dpwplink-url-vars__item--id-only")):$(o?"#dpwplink-sys-url-vars":"#dpwplink-url-vars").append(this.getUrlVarExampleHtml(i,t,e,o))}),$(".dpwplink-url-vars__item--id-only").on("click",this.onUrlVarClick);let t=i.length;do{var o=$('.dpwplink-url-vars__item[data-idx="'.concat(t,'"]'));o.addClass("dpwplink-url-vars__item--inactive").hide(),t++}while(o.length)}}getUrlExamples(){if(!this.isFirstStep)return null;if(!this.enableUrlVarExamples)return this.nonActiveUrlVarExamples;const t=this.isVariableUrl(this.inputs.url.val(),!0)&&this.enableUrlVarExamples;if(t){const e={};return $(".dpwplink-url-vars__item:not(.dpwplink-url-vars__item--inactive)").each((i,s)=>{const o=$(s).data("var-id");o&&($(s).hasClass("dpwplink-url-vars__item--system")&&this.sysUrlVars?e[o]=this.sysUrlVars[o]:t&&(e[o]=$(s).find("input").val()))}),e}return this.sysUrlVars}setUrlExamples(t){if(!this.enableUrlVarExamples||!this.isFirstStep)return null;t||(t={}),Object.keys(t).forEach(e=>{$('.dpwplink-url-vars__item[data-var-id="'.concat(e,'"]')).find("input").val(t[e])})}getUrlVarExampleHtml(t,e,i){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const o=n()({"dpwplink-url-vars__item":!0,"dpwplink-url-vars__item--id-only":!i||s,"dpwplink-url-vars__item--system":s});return'<li class="'.concat(o,'" data-idx="').concat(t,'" data-var-id="').concat(e,'"><span>{').concat(e,"}</span><input></li>")}updateAfterUrlChanged(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateSubmitButton(),this.updateVariableUrlsGUI(t)}isVariableUrl(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)return!1;const i=t.indexOf("{");if(e&&i>=0)return!0;const s=t.indexOf("}");return i>=0&&s>i}isVariableTypingInProcess(t){if(!t)return!1;const e=t.lastIndexOf("{"),i=t.lastIndexOf("}");return e>=0&&e>i}cancelVariableTypingInProcess(){const t=this.inputs.url.val();if(this.isVariableTypingInProcess(t)){const e=t.lastIndexOf("{");e>=0&&this.inputs.url.val(t.substring(0,e))}}updateFields(t,e){if(e.length){const t=e.children(".item-permalink").val();this.inputs.url.val(this.sanitizeUrl(t,!0)),this.updateAfterUrlChanged(),this.inputs.wrap.hasClass("has-text-field")&&!this.inputs.text.val()&&this.inputs.text.val($(e[0]).children(".item-title").text())}}setDefaultValues(){this.inputs.url.val(""),this.updateAfterUrlChanged(),this.inputs.search.val(""),this.searchInternalLinks(),this.inputs.submit.val(this.config.save)}searchInternalLinks(){let t;const e=this.inputs.search.val()||"",i=parseInt(this.config.minInputLength,10)||3;if(e.length>=i){if(this.rivers.recent.hide(),this.rivers.search.show(),this.lastSearch==e)return;this.lastSearch=e,t=this.inputs.search.parent().find(".spinner").addClass("is-active"),this.rivers.search.change(e),this.rivers.search.ajax(()=>{t.removeClass("is-active")})}else this.rivers.search.hide(),this.rivers.recent.show()}keydown(t){if(this.modalOpen){if(27===t.keyCode)$("#dpit-wp-link-cancel").trigger("click"),t.stopImmediatePropagation();else if(9===t.keyCode){const e=t.target.id;"dp_wp-link-submit"!==e||t.shiftKey?"dpit-wp-link-cancel"===e&&t.shiftKey&&(this.inputs.submit.focus(),t.preventDefault()):t.preventDefault()}if(t.shiftKey||38!==t.keyCode&&40!==t.keyCode)return;if(document.activeElement&&("link-title-field"===document.activeElement.id||"url-field"===document.activeElement.id))return;const e=38===t.keyCode?"prev":"next";clearInterval(this.keyInterval),this[e](),this.keyInterval=setInterval(this[e],this.keySensitivity),t.preventDefault()}}keyup(t){38!==t.keyCode&&40!==t.keyCode||(clearInterval(this.keyInterval),t.preventDefault())}}},57:function(t,e,i){}},[[179,0,4,2]]]);
//# sourceMappingURL=dpit-admin-tour-edit-3c048cf5.js.map