{"version":3,"sources":["webpack:///./public/assets/js/modules/core/DpitTarget.js","webpack:///./public/assets/js/modules/core/DpitTargetParent.js","webpack:///./public/assets/js/modules/core/DpitTargetBranch.js"],"names":["DpitTarget","constructor","element","_defineProperty","className","this","classList","contains","$element","$","beforeOffset","offset","add","afterOffset","setOffset","Math","abs","top","attrsBkp","style","left","cssPosition","getComputedStyle","getPropertyValue","analysis","isSticky","isFixed","hasAltPosition","includes","process","CLASSES_CORE","target","addClassSafe","relativePosition","destroy","remove","removeClassSafe","Object","keys","forEach","propName","setAttribute","DpitTargetParent","super","computedStyle","zIndex","opacity","getComputedCssValFloat","hasFilter","hasCssPropertyPrefixed","hasTransform","hasDecreasedOpacity","hasZIndex","test","isScrollable","isElementScrollable","isZIdxFixParent","targetParent","needsZIndexFix","doesNeedZIndexFix","MODIFIERS","zIdxFix","DpitTargetBranch","targetElement","dpDebugEn","initBranch","initProcessData","closestFixedPosItem","fixedPosElements","stickyPosElements","scrollableElements","branchItems","distance","push","parentNode","tagName","toLowerCase","getTargetItem","containsFixed","_this$fixedPosElement","length","containsFixedParent","_this$closestFixedPos","getClosestFixedParent","_this$closestFixedPos2","getFirstScrollableChildFromClosestFixedParent","_this$closestFixedPos3","closestFixedPosItemIdx","indexOf","distanceFromTarget","item","containsSticky","_this$stickyPosElemen","containsScrollable","_this$scrollableEleme","console","log"],"mappings":"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","file":"main/DpitTargetBranch-e8aaf180.js","sourcesContent":["import { CLASSES_CORE } from './constants';\r\n\r\nexport default class DpitTarget {\r\n\r\n\t/**\r\n\t * Initialize target object\r\n\t *\r\n\t * @param {Element} element\r\n\t*/\r\n\tconstructor(element) {\r\n\t\tthis.element = element;\r\n\t\tconst computedStyle = getComputedStyle(element);\r\n\t\tconst cssPosition = computedStyle.getPropertyValue('position');\r\n\t\tthis.analysis = {\r\n\t\t\tisSticky: cssPosition === 'sticky',\r\n\t\t\tisFixed: cssPosition === 'fixed',\r\n\t\t\thasAltPosition: ['fixed', 'sticky', 'absolute'].includes(cssPosition),\r\n\t\t\t//isSvg: element.tagName.toLowerCase() === 'svg',\r\n\t\t};\r\n\t}\r\n\r\n\tprocess() {\r\n\t\tthis.attrsBkp = {};\r\n\t\tthis.element.classList.add(CLASSES_CORE.target);\r\n\t\tif (this.analysis.hasAltPosition) {\r\n\t\t\tthis.addClassSafe(CLASSES_CORE.relativePosition);\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tdestroy() {\r\n\t\tthis.element.classList.remove(CLASSES_CORE.target);\r\n\t\tthis.removeClassSafe(CLASSES_CORE.relativePosition);\r\n\t}\r\n\r\n\r\n\taddClassSafe = (className) => {\r\n\t\tif (!this.element.classList.contains(className)) {\r\n\t\t\tconst $element = $(this.element);\r\n\t\t\tconst beforeOffset = $element.offset();\r\n\t\t\tthis.element.classList.add(className);\r\n\t\t\tconst afterOffset = $element.offset();\r\n\r\n\t\t\tlet setOffset = false;\r\n\t\t\tif (Math.abs(afterOffset.top - beforeOffset.top) > 1) {\r\n\t\t\t\tthis.attrsBkp.top = this.element.style.top;\r\n\t\t\t\tsetOffset = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (Math.abs(afterOffset.left - beforeOffset.left) > 1) {\r\n\t\t\t\tthis.attrsBkp.left = this.element.style.left;\r\n\t\t\t\tsetOffset = true;\r\n\t\t\t}\r\n\t\t\tif (setOffset) {\r\n\t\t\t\t$element.offset(beforeOffset);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tremoveClassSafe(className) {\r\n\t\tif (this.element.classList.contains(className)) {\r\n\t\t\tthis.element.classList.remove(className);\r\n\t\t}\r\n\t\tif (this.attrsBkp) {\r\n\t\t\tObject.keys(this.attrsBkp).forEach(propName => {\r\n\t\t\t\tthis.element.setAttribute(propName, this.attrsBkp[propName]);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n}","\r\nimport { getComputedCssValFloat, hasCssPropertyPrefixed, isElementScrollable } from '../dpitUtilsPublic';\r\nimport DpitTarget from './DpitTarget';\r\nimport { CLASSES_CORE, MODIFIERS } from './constants';\r\n\r\n\r\n\r\nexport default class DpitTargetParent extends DpitTarget {\r\n\t/**\r\n\t * Initialize target object\r\n\t *\r\n\t * @param {Element} element\r\n\t*/\r\n\tconstructor(element) {\r\n\t\tsuper(element);\r\n\t\tconst computedStyle = getComputedStyle(element);\r\n\t\tconst zIndex = computedStyle.getPropertyValue('z-index');\r\n\t\tconst opacity = getComputedCssValFloat(element, 'opacity', 1, computedStyle);\r\n\t\tthis.analysis = {\r\n\t\t\t...this.analysis,\r\n\t\t\thasFilter: hasCssPropertyPrefixed(computedStyle, 'filter'),\r\n\t\t\thasTransform: hasCssPropertyPrefixed(computedStyle, 'transform'),\r\n\t\t\thasDecreasedOpacity: opacity < 1,\r\n\t\t\thasZIndex: /[0-9]+/.test(zIndex),\r\n\t\t\tisScrollable: isElementScrollable(element, computedStyle)\r\n\t\t};\r\n\t}\r\n\r\n\tprocess(isZIdxFixParent) {\r\n\t\tthis.element.classList.add(CLASSES_CORE.targetParent);\r\n\t\tthis.needsZIndexFix = this.doesNeedZIndexFix(isZIdxFixParent, this.analysis);\r\n\t\tif (this.needsZIndexFix) {\r\n\t\t\tthis.addClassSafe(CLASSES_CORE.targetParent + MODIFIERS.zIdxFix);\r\n\t\t}\r\n\t}\r\n\r\n\tdoesNeedZIndexFix(isZIdxFixParent, analysis) {\r\n\t\treturn isZIdxFixParent || analysis.hasTransform || analysis.hasFilter || analysis.hasDecreasedOpacity || analysis.hasZIndex || analysis.hasAltPosition;\r\n\t}\r\n\r\n\tdestroy() {\r\n\t\tthis.element.classList.remove(CLASSES_CORE.targetParent);\r\n\t\tthis.removeClassSafe(CLASSES_CORE.targetParent + MODIFIERS.zIdxFix);\r\n\t}\r\n}","\r\nimport { } from '../dpitUtilsPublic';\r\nimport DpitTarget from './DpitTarget';\r\nimport DpitTargetParent from './DpitTargetParent';\r\n\r\n\r\nexport default class DpitTargetBranch {\r\n\tconstructor(targetElement, dpDebugEn) {\r\n\t\tthis.dpDebugEn = dpDebugEn;\r\n\t\t//this.initProcessData();\r\n\t\tthis.initBranch(targetElement, dpDebugEn);\r\n\t}\r\n\r\n\tinitProcessData() {\r\n\t\tthis.isZIdxFixParent = false;\r\n\t\tthis.closestFixedPosItem = null;\r\n\t\tthis.fixedPosElements = [];\r\n\t\tthis.stickyPosElements = [];\r\n\t\tthis.scrollableElements = [];\r\n\t}\r\n\r\n\r\n\tinitBranch(targetElement) {\r\n\t\tthis.branchItems = [];\r\n\t\tif (targetElement) {\r\n\t\t\tlet element = targetElement;\r\n\t\t\tlet distance = 0;\r\n\t\t\tdo {\r\n\t\t\t\tswitch (distance) {\r\n\t\t\t\t\tcase 0: this.branchItems.push(new DpitTarget(element)); break;\r\n\t\t\t\t\tdefault: this.branchItems.push(new DpitTargetParent(element)); break;\r\n\t\t\t\t}\r\n\t\t\t\telement = element.parentNode;\r\n\t\t\t\tdistance++;\r\n\t\t\t\tif (!element.tagName || element.tagName.toLowerCase() === 'body') break;\r\n\t\t\t} while (element !== null);\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tgetTargetItem() {\r\n\t\treturn this.branchItems[0];\r\n\t}\r\n\r\n\tcontainsFixed() {\r\n\t\treturn this.fixedPosElements?.length > 0;\r\n\t}\r\n\r\n\tcontainsFixedParent() {\r\n\t\treturn this.closestFixedPosItem?.element !== null;\r\n\t}\r\n\r\n\tgetClosestFixedParent() {\r\n\t\treturn this.closestFixedPosItem?.element;\r\n\t}\r\n\r\n\tgetFirstScrollableChildFromClosestFixedParent() {\r\n\t\tif (!this.closestFixedPosItem?.element || !this.branchItems) return null;\r\n\t\tconst closestFixedPosItemIdx = this.branchItems.indexOf(this.closestFixedPosItem, 1);\r\n\t\tif (closestFixedPosItemIdx > 0) {\r\n\t\t\tfor (let distanceFromTarget = closestFixedPosItemIdx; distanceFromTarget > 0; distanceFromTarget--) {\r\n\t\t\t\tconst item = this.branchItems[distanceFromTarget];\r\n\t\t\t\tif (item.analysis.isScrollable) {\r\n\t\t\t\t\treturn item.element;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tcontainsSticky() {\r\n\t\treturn this.stickyPosElements?.length > 0;\r\n\t}\r\n\r\n\tcontainsScrollable() {\r\n\t\treturn this.scrollableElements?.length > 0;\r\n\t}\r\n\r\n\tprocess() {\r\n\t\tthis.initProcessData();\r\n\t\tthis.branchItems.forEach(item => {\r\n\t\t\titem.process(this.isZIdxFixParent);\r\n\t\t\tif (!this.isZIdxFixParent && item.needsZIndexFix) this.isZIdxFixParent = true;\r\n\r\n\t\t\tif (item.analysis.isFixed) {\r\n\t\t\t\tthis.fixedPosElements.push(item.element);\r\n\t\t\t\tif (item !== this.getTargetItem()) {\r\n\t\t\t\t\tthis.closestFixedPosItem = item;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (item.analysis.isSticky) this.stickyPosElements.push(item.element);\r\n\t\t\tif (item.analysis.isScrollable) this.scrollableElements.push(item.element);\r\n\t\t});\r\n\t\tif (this.dpDebugEn) console.log('[dpit] Branch analysis:', this.branchItems, this);\r\n\t}\r\n\r\n\tdestroy() {\r\n\t\tthis.branchItems.forEach(item => {\r\n\t\t\titem.destroy();\r\n\t\t});\r\n\t}\r\n\r\n\r\n}"],"sourceRoot":""}