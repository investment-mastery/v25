{"version":3,"sources":["webpack:///./includes/assets/js/modules/dpitHidden.js","webpack:///./public/assets/js/modules/core/EventListeners.js","webpack:///./public/assets/js/modules/core/ExclusiveClickListener.js","webpack:///./public/assets/js/modules/core/DpitUserInteraction.js"],"names":["hideElement","element","byOpacity","arguments","length","undefined","noSpace","noTransition","transitionBkp","style","transition","classList","add","setTimeout","showElement","remove","EventListeners","constructor","this","listeners","getEventId","type","eventId","Date","getTime","Math","random","toString","functionRef","addEventListener","_this$listeners$event","removeEventListener","removeAll","Object","keys","forEach","ExclusiveClickListener","stopPropagationEnabled","disableAllPointerEvents","suppressParentsLinkElements","excludeTargetBlank","leftButtonOnly","data","noEventTimeoutAfterVeryFirstClickMs","addElements","elements","addElement","dataItem","noEventsData","push","event","handleVeryFirstClickEvent","handleFollowingClickEvents","clear","clearNoEvents","bind","dataBkp","activateAfterClear","isLeftClickEvent","button","res","Function","stopImmediatePropagation","activateNoEvents","preventDefault","startNoEventTimeout","onCleared","noEventsTimeout","clearTimeout","noEventElements","getParentsLinkElements","addElementNoEvents","pointerEventsProp","getPropertyValue","setProperty","pointerEventsBkp","clearNoEventsOnNoEventsItem","noEventsDataItem","removeProperty","DpitUserInteraction","options","tooltipRefEl","animation","onIterateStep","onIterateStepInProgress","onBeforeUnloadByLinkClick","debugEn","console","log","isIterateStepInAction","hoverListeners","linkClickListener","processTargetLinkClick","iterateClickListener","iterateStepAfterUserAction","blockClickListener","update","stepItem","destroy","updateIterateAfterClick","updateIterateAfterHover","updateLinkClick","clearIterateAfterClick","clearIterateAfterHover","clearTargetLinkClickAdjustment","updateDisableInteractionLayer","wrapEl","moveLayer2TargetFce","enable_interaction","val","insertDisableInteractionLayer","removeDisableInteractionLayer","disableInteractionLayer","document","createElement","className","CLASSES_CORE","disableInteraction","insertBefore","parentNode","removeChild","_this$stepItem","isBlockClicks","isIterateAfterClick","startTargetLinkClickAdjustment","_this$stepItem2","allElementsToBlock","getParentsAndChildrenLinkElements","linkElement","disabled","userInteractionTryWhenDisabledFce","hrefAttribute","getAttribute","isOpenTargetLinkClicksInNewTab","dpDebugEn","defaultPrevented","window","open","exception","error","target","MODIFIERS","click","blockClick","disable","enable","_this$stepItem$enable","_this$stepItem$enable2","_this$stepItem$enable3","delay","ext","iterate_after_click_delay_ms","TIMING","defaultIterateAfterClick","start","_this$stepItem3","stop","isInteractionFeatureEnabled","featureId","isIterateAfterHover","hover","_this$stepItem$enable4","iterate_after_hover"],"mappings":"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","file":"main/DpitUserInteraction-e86d5743.js","sourcesContent":["/**\r\n * @param {Element} element element to hide\r\n */\r\nexport const hideElement = (element, byOpacity = true, noSpace = false, noTransition = false) => {\r\n\tif (element) {\r\n\t\tlet transitionBkp = '';\r\n\t\tif (noTransition) {\r\n\t\t\ttransitionBkp = element.style.transition;\r\n\t\t\telement.style.transition = 'unset';\r\n\t\t}\r\n\r\n\t\telement.classList.add('dpit-hidden');\r\n\t\tif (!byOpacity) element.classList.add('dpit-hidden--by-disp');\r\n\t\tif (noSpace) element.classList.add('dpit-hidden--no-space');\r\n\r\n\t\tif (noTransition) {\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\telement.style.transition = transitionBkp;\r\n\t\t\t}, 50);\r\n\t\t}\r\n\t}\r\n};\r\n\r\n/**\r\n * @param {Element} element element to hide\r\n */\r\nexport const hideElementImmediately = (element, byOpacity = true, noSpace = false) => {\r\n\thideElement(element, byOpacity, noSpace, true);\r\n};\r\n\r\n/**\r\n * @param {Element} element element to hide\r\n */\r\nexport const showElement = (element) => {\r\n\tif (element) {\r\n\t\telement.classList.remove('dpit-hidden', 'dpit-hidden--no-space', 'dpit-hidden--by-disp', 'dpit-hidden-keep-events');\r\n\t}\r\n};","\r\nexport default class EventListeners {\r\n\tconstructor() {\r\n\t\tthis.listeners = {};\r\n\t}\r\n\r\n\t/**\r\n\t * If not eventId set, generate generic ID\r\n\t * @param {string} type event type key\r\n\t * @param {string} eventId event id\r\n\t */\r\n\tgetEventId(type, eventId = null) {\r\n\t\treturn eventId ?? type + (new Date()).getTime() + Math.random().toString(36);\r\n\t}\r\n\t/**\r\n\t * Subscribe event on element and store data for unsubscribe\r\n\t *\r\n\t * @param {Element} element element where event occurs\r\n\t * @param {string} type event type key\r\n\t * @param {Function} functionRef to run while event occurs\r\n\t * @param {string} eventId event id\r\n\t */\r\n\tadd(element, type, functionRef, eventId = null) {\r\n\t\tif (element && type && functionRef) {\r\n\t\t\tthis.listeners[this.getEventId(type, eventId)] = {\r\n\t\t\t\ttype: type,\r\n\t\t\t\tfunctionRef: functionRef,\r\n\t\t\t\telement: element,\r\n\t\t\t};\r\n\t\t\telement.addEventListener(type, functionRef);\r\n\t\t}\r\n\t}\r\n\r\n\r\n\r\n\t/**\r\n\t * Unsubscribe event on element and delete stored data\r\n\t * @param {string} eventId event id\r\n\t*/\r\n\tremove(eventId) {\r\n\t\tif (this.listeners[eventId] && this.listeners[eventId]) {\r\n\t\t\tconst { element, type, functionRef } = this.listeners[eventId];\r\n\t\t\tif (element && type && functionRef) {\r\n\t\t\t\telement.removeEventListener(type, functionRef);\r\n\t\t\t\tdelete this.listeners[eventId];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Unsubscribe all stored events and delete stored data\r\n\t*/\r\n\tremoveAll() {\r\n\t\tObject.keys(this.listeners).forEach(eventId => {\r\n\t\t\tthis.remove(eventId);\r\n\t\t});\r\n\t}\r\n}","import { getParentsLinkElements } from '../dpitUtilsPublic';\r\nimport EventListeners from './EventListeners';\r\n\r\nexport default class ExclusiveClickListener {\r\n\t/**\r\n\t * Init module for adjusting a click events, so only first event is captured and rest possibly registered events are suppressed \r\n\t *\r\n\t * @param {Function} functionRef to run while event occurs\r\n\t * @param {Boolean} stopPropagationEnabled should be propagation of click events stopped\r\n\t * @param {Boolean} leftButtonOnly only left mouse button is captured\r\n\t */\r\n\tconstructor(functionRef, stopPropagationEnabled = true, disableAllPointerEvents = true, suppressParentsLinkElements = false, excludeTargetBlank = false, leftButtonOnly = true) {\r\n\t\tthis.data = [];\r\n\t\tthis.noEventTimeoutAfterVeryFirstClickMs = 1000;\r\n\t\tthis.stopPropagationEnabled = stopPropagationEnabled;\r\n\t\tthis.leftButtonOnly = leftButtonOnly;\r\n\t\tthis.excludeTargetBlank = excludeTargetBlank;\r\n\t\tthis.disableAllPointerEvents = disableAllPointerEvents;\r\n\t\tthis.suppressParentsLinkElements = suppressParentsLinkElements;\r\n\t\tthis.listeners = new EventListeners();\r\n\t\tthis.functionRef = functionRef;\r\n\t}\r\n\t/**\r\n\t * Subscribe element click events so only first event is captured and rest possibly registered events are suppressed \r\n\t *\r\n\t * @param {HTMLCollection|Array} elements element or elements, where subscribe exclusive click\r\n\t*/\r\n\taddElements(elements) {\r\n\t\tif (elements) {\r\n\t\t\telements.forEach((element) => this.addElement(element));\r\n\t\t}\r\n\t}\r\n\r\n\taddElement(element) {\r\n\t\tif (element) {\r\n\t\t\tconst dataItem = {\r\n\t\t\t\telement: element,\r\n\t\t\t\tnoEventsData: null\r\n\t\t\t};\r\n\t\t\tthis.data.push = dataItem;\r\n\t\t\tthis.listeners.add(element, 'mousedown', (event) => this.handleVeryFirstClickEvent(event, dataItem));\r\n\t\t\tthis.listeners.add(element, 'touchstart', (event) => this.handleVeryFirstClickEvent(event, dataItem));\r\n\t\t\tthis.listeners.add(element, 'click', (event) => this.handleFollowingClickEvents(event, dataItem));\r\n\t\t\tthis.listeners.add(element, 'mouseup', (event) => this.handleFollowingClickEvents(event, dataItem));\r\n\t\t\tthis.listeners.add(element, 'touchend', (event) => this.handleFollowingClickEvents(event, dataItem));\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Unsubscribe all subscribed events and clear pointer-events modification\r\n\t * @param {Element} element element to unsubscribe\r\n\t*/\r\n\tclear(immediate = false) {\r\n\r\n\t\tif (immediate) {\r\n\t\t\tthis.data.forEach(this.clearNoEvents.bind(this));\r\n\t\t}\r\n\t\telse {\r\n\t\t\tconst dataBkp = [...this.data];\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tdataBkp.forEach(this.clearNoEvents.bind(this));\r\n\t\t\t}, this.noEventTimeoutAfterVeryFirstClickMs);\r\n\t\t}\r\n\r\n\t\tthis.data = [];\r\n\t\tthis.listeners.removeAll();\r\n\t}\r\n\r\n\tactivateAfterClear() {\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.clear(true);\r\n\t\t}, this.noEventTimeoutAfterVeryFirstClickMs);\r\n\t}\r\n\r\n\tisLeftClickEvent(event) {\r\n\t\tif (!this.leftButtonOnly) return true;\r\n\t\treturn event.button === 0;\r\n\t}\r\n\r\n\thandleVeryFirstClickEvent(event, dataItem) {\r\n\t\tlet res = true;\r\n\t\tif (this.isLeftClickEvent(event)) {\r\n\t\t\tres = false;\r\n\t\t\t//console.log('handleFollowingClickEvents sssssssssssssssssssssssssssssssssssssssssssssssssssssss', event.type, event);\r\n\t\t\tif (this.functionRef instanceof Function) {\r\n\t\t\t\tres = this.functionRef(event, dataItem.element);\r\n\t\t\t}\r\n\t\t\tif (!res) {\r\n\t\t\t\tif (this.stopPropagationEnabled) event.stopImmediatePropagation();\r\n\t\t\t\tthis.activateNoEvents(dataItem);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn res;\r\n\t}\r\n\r\n\thandleFollowingClickEvents(event, dataItem) {\r\n\t\t//console.log('handleFollowingClickEvents sssssssssssssssssssssssssssssssssssssssssssssssssssssss', event.type, event);\r\n\t\tif (this.isLeftClickEvent(event)) {\r\n\t\t\tif (event.type === 'click') event.preventDefault();\r\n\t\t\tif (this.stopPropagationEnabled) {\r\n\t\t\t\tevent.stopImmediatePropagation();\r\n\t\t\t}\r\n\t\t\tthis.activateNoEvents(dataItem);\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\tstartNoEventTimeout(dataItem, onCleared) {\r\n\t\tif (dataItem.noEventsTimeout) clearTimeout(dataItem.noEventsTimeout);\r\n\t\tdataItem.noEventsTimeout = setTimeout(() => {\r\n\t\t\tthis.clearNoEvents(dataItem);\r\n\t\t\tif (onCleared instanceof Function) onCleared(dataItem.element);\r\n\t\t}, this.noEventTimeoutAfterVeryFirstClickMs);\r\n\t}\r\n\r\n\tactivateNoEvents(dataItem) {\r\n\t\tif (this.disableAllPointerEvents) {\r\n\t\t\tif (!dataItem.noEventsData) {\r\n\t\t\t\tlet noEventElements = [dataItem.element];\r\n\t\t\t\tif (this.suppressParentsLinkElements) {\r\n\t\t\t\t\tnoEventElements = getParentsLinkElements(dataItem.element, true, this.excludeTargetBlank);\r\n\t\t\t\t}\r\n\t\t\t\tnoEventElements.forEach((element) => this.addElementNoEvents(dataItem, element));\r\n\t\t\t\tthis.startNoEventTimeout(dataItem);\r\n\t\t\t} else {\r\n\t\t\t\tthis.startNoEventTimeout(dataItem);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\taddElementNoEvents(dataItem, element) {\r\n\t\tif (dataItem && element) {\r\n\t\t\tconst pointerEventsProp = element.style.getPropertyValue('pointer-events');\r\n\t\t\telement.style.setProperty('pointer-events', 'none', 'important');\r\n\t\t\tif (!dataItem.noEventsData) dataItem.noEventsData = [];\r\n\t\t\tdataItem.noEventsData.push({\r\n\t\t\t\telement,\r\n\t\t\t\tpointerEventsBkp: pointerEventsProp\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tclearNoEvents(dataItem) {\r\n\t\tif (dataItem.noEventsData) {\r\n\t\t\tdataItem.noEventsData.forEach(this.clearNoEventsOnNoEventsItem.bind(this));\r\n\t\t\tif (dataItem.noEventsTimeout) clearTimeout(dataItem.noEventsTimeout);\r\n\t\t\tdataItem.noEventsTimeout = null;\r\n\t\t}\r\n\t\tdataItem.noEventsData = null;\r\n\t}\r\n\r\n\tclearNoEventsOnNoEventsItem(noEventsDataItem) {\r\n\t\tif (noEventsDataItem?.element) {\r\n\t\t\tif (noEventsDataItem.pointerEventsBkp) {\r\n\t\t\t\tnoEventsDataItem.element.style.setProperty('pointer-events', noEventsDataItem.pointerEventsBkp);\r\n\t\t\t}\r\n\t\t\telse noEventsDataItem.element.style.removeProperty('pointer-events');\r\n\t\t}\r\n\t}\r\n\r\n}","import { showElement } from '../../../../../includes/assets/js/modules/dpitHidden';\r\nimport { getParentsAndChildrenLinkElements } from '../dpitUtilsPublic';\r\nimport { MODIFIERS, TIMING, CLASSES_CORE } from './constants';\r\nimport EventListeners from './EventListeners';\r\nimport ExclusiveClickListener from './ExclusiveClickListener';\r\n\r\n\r\nexport default class DpitUserInteraction {\r\n\r\n\tconstructor(options, tooltipRefEl, animation, onIterateStep, onIterateStepInProgress, onBeforeUnloadByLinkClick) {\r\n\t\tif (options.debugEn) console.log('[dpit] INIT DpitUserInteraction');\r\n\t\tthis.onBeforeUnloadByLinkClick = onBeforeUnloadByLinkClick;\r\n\t\tthis.tooltipRefEl = tooltipRefEl;\r\n\t\tthis.options = options;\r\n\t\tthis.animation = animation;\r\n\t\tthis.onIterateStep = onIterateStep;\r\n\t\tthis.onIterateStepInProgress = onIterateStepInProgress;\r\n\t\tthis.isIterateStepInAction = false;\r\n\t\tthis.hoverListeners = new EventListeners();\r\n\t\tthis.linkClickListener = new ExclusiveClickListener(this.processTargetLinkClick.bind(this), true, false, false, true);\r\n\t\tthis.iterateClickListener = new ExclusiveClickListener(this.iterateStepAfterUserAction.bind(this));\r\n\t\tthis.blockClickListener = new ExclusiveClickListener();\r\n\t}\r\n\r\n\tupdate(stepItem) {\r\n\t\tthis.destroy();\r\n\t\tthis.stepItem = { ...stepItem };\r\n\t\tthis.element = stepItem?.element;\r\n\t\tthis.updateIterateAfterClick();\r\n\t\tthis.updateIterateAfterHover();\r\n\t\tthis.updateLinkClick();\r\n\t}\r\n\r\n\r\n\tdestroy() {\r\n\t\tthis.clearIterateAfterClick();\r\n\t\tthis.clearIterateAfterHover();\r\n\t\tthis.clearTargetLinkClickAdjustment();\r\n\t\tthis.iterateClickListener.clear(true);\r\n\t\tthis.blockClickListener.clear(true);\r\n\t\tthis.hoverListeners.removeAll();\r\n\t}\r\n\r\n\r\n\r\n\tupdateDisableInteractionLayer(stepItem, wrapEl, moveLayer2TargetFce) {\r\n\t\tif (stepItem && stepItem.enable_interaction.val != '1') {\r\n\t\t\tthis.insertDisableInteractionLayer(wrapEl, moveLayer2TargetFce);\r\n\t\t} else {\r\n\t\t\tthis.removeDisableInteractionLayer();\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tinsertDisableInteractionLayer(wrapEl, moveLayer2TargetFce) {\r\n\t\tif (!this.disableInteractionLayer && this.tooltipRefEl) {\r\n\t\t\tthis.disableInteractionLayer = document.createElement('div');\r\n\t\t\tthis.disableInteractionLayer.className = CLASSES_CORE.disableInteraction;\r\n\t\t\twrapEl.insertBefore(this.disableInteractionLayer, this.tooltipRefEl);\r\n\t\t}\r\n\t\tif (moveLayer2TargetFce instanceof Function) moveLayer2TargetFce(this.disableInteractionLayer);\r\n\t}\r\n\r\n\tremoveDisableInteractionLayer() {\r\n\t\tif (this.disableInteractionLayer) {\r\n\t\t\tthis.disableInteractionLayer.parentNode.removeChild(this.disableInteractionLayer);\r\n\t\t\tthis.disableInteractionLayer = null;\r\n\t\t}\r\n\t}\r\n\r\n\tupdateLinkClick() {\r\n\t\tif (this.stepItem?.element && !this.isBlockClicks() && !this.isIterateAfterClick(this.stepItem)) {\r\n\t\t\tthis.startTargetLinkClickAdjustment();\r\n\t\t} else {\r\n\t\t\tthis.clearTargetLinkClickAdjustment();\r\n\t\t}\r\n\t}\r\n\r\n\tstartTargetLinkClickAdjustment() {\r\n\t\tthis.linkClickListener.clear(true);\r\n\t\tconst allElementsToBlock = getParentsAndChildrenLinkElements(this.stepItem?.element, true);\r\n\t\tif (allElementsToBlock) {\r\n\t\t\tthis.linkClickListener.addElements(allElementsToBlock);\r\n\t\t}\r\n\t}\r\n\r\n\tclearTargetLinkClickAdjustment() {\r\n\t\tthis.linkClickListener.clear(true);\r\n\t}\r\n\r\n\t/**\r\n\t * Force to open link element in new tab\r\n\t * @param {Event} event click event\r\n\t * @param {Element} linkElement element where event occurs\r\n\t */\r\n\tprocessTargetLinkClick(event, linkElement) {\r\n\r\n\t\tif (this.disabled && this.userInteractionTryWhenDisabledFce) {\r\n\t\t\tthis.userInteractionTryWhenDisabledFce();\r\n\t\t}\r\n\t\tconst isBlockClicks = this.isBlockClicks();\r\n\r\n\t\tif (!this.isIterateStepInAction && !this.disabled && linkElement && !isBlockClicks && !this.isIterateAfterClick(this.stepItem)) {\r\n\t\t\tconst hrefAttribute = linkElement.getAttribute('href');\r\n\r\n\t\t\tif (hrefAttribute && event) {\r\n\t\t\t\tconst targetAttribute = linkElement.getAttribute('target');\r\n\t\t\t\tif (targetAttribute === '_blank' || this.isOpenTargetLinkClicksInNewTab()) {\r\n\t\t\t\t\tif (this.options.dpDebugEn) console.log('[dpit] TARGET CLICK: <a> element inside a target was clicked and opened in new tab.');\r\n\t\t\t\t\tif (!event.defaultPrevented) {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\twindow.open(hrefAttribute, '_blank');\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t} catch (exception) {\r\n\t\t\t\t\t\t\tconsole.error(exception);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (this.onBeforeUnloadByLinkClick instanceof Function) {\r\n\t\t\t\t\tthis.onBeforeUnloadByLinkClick(hrefAttribute);\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (event && isBlockClicks) {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\tevent.stopImmediatePropagation();\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\tclearIterateAfterClick() {\r\n\t\tif (this.element) {\r\n\t\t\tthis.element.classList.remove(\r\n\t\t\t\tCLASSES_CORE.target + MODIFIERS.click,\r\n\t\t\t\tCLASSES_CORE.target + MODIFIERS.blockClick\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\tupdateIterateAfterClick() {\r\n\t\tif (this.element) {\r\n\t\t\tthis.iterateClickListener.clear(true);\r\n\t\t\tif (this.isIterateAfterClick(this.stepItem)) {\r\n\t\t\t\tthis.iterateClickListener.addElement(this.element);\r\n\t\t\t\tthis.element.classList.add(CLASSES_CORE.target + MODIFIERS.click);\r\n\t\t\t}\r\n\t\t\telse if (this.isBlockClicks(this.stepItem)) {\r\n\t\t\t\tthis.blockClickListener.addElement(this.element);\r\n\t\t\t\tthis.element.classList.add(CLASSES_CORE.target + MODIFIERS.blockClick);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tdisable(userInteractionTryWhenDisabledFce) {\r\n\t\tthis.disabled = true;\r\n\t\tthis.userInteractionTryWhenDisabledFce = userInteractionTryWhenDisabledFce;\r\n\t}\r\n\r\n\tenable() {\r\n\t\tthis.disabled = false;\r\n\t\tthis.userInteractionTryWhenDisabledFce = null;\r\n\t}\r\n\r\n\r\n\titerateStepAfterUserAction() {\r\n\r\n\t\tif (this.disabled && this.userInteractionTryWhenDisabledFce) this.userInteractionTryWhenDisabledFce();\r\n\r\n\t\tif (!this.isIterateStepInAction && !this.disabled && this.stepItem) {\r\n\t\t\tthis.isIterateStepInAction = true;\r\n\t\t\tlet delay = this.stepItem.enable_interaction?.ext?.iterate_after_click_delay_ms ?? TIMING.defaultIterateAfterClick;\r\n\t\t\tthis.animation.start();\r\n\t\t\t//hideElement(this.stepItem?.element);\r\n\t\t\tif (this.onIterateStepInProgress instanceof Function) {\r\n\t\t\t\tthis.onIterateStepInProgress(true);\r\n\t\t\t}\r\n\t\t\tthis.destroy();\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis.animation.stop();\r\n\t\t\t\tshowElement(this.stepItem?.element);\r\n\t\t\t\tif (this.onIterateStepInProgress instanceof Function) {\r\n\t\t\t\t\tthis.onIterateStepInProgress(false);\r\n\t\t\t\t}\r\n\t\t\t\tif (this.onIterateStep instanceof Function) {\r\n\t\t\t\t\tthis.onIterateStep();\r\n\t\t\t\t}\r\n\t\t\t\tthis.isIterateStepInAction = false;\r\n\t\t\t}, delay);\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tisInteractionFeatureEnabled(featureId) {\r\n\t\treturn this.stepItem\r\n\t\t\t&& this.stepItem.element\r\n\t\t\t&& this.stepItem.enable_interaction.val == '1'\r\n\t\t\t&& this.stepItem.enable_interaction.ext\r\n\t\t\t&& this.stepItem.enable_interaction.ext[featureId] == '1';\r\n\t}\r\n\r\n\tisIterateAfterClick() {\r\n\t\treturn this.isInteractionFeatureEnabled('iterate_after_click');\r\n\t}\r\n\r\n\tisOpenTargetLinkClicksInNewTab() {\r\n\t\treturn this.isInteractionFeatureEnabled('open_target_link_clicks_in_new_tab');\r\n\t}\r\n\r\n\tisBlockClicks() {\r\n\t\treturn this.isInteractionFeatureEnabled('iterate_after_click_stop_propagation');\r\n\t}\r\n\r\n\r\n\tupdateIterateAfterHover() {\r\n\t\tif (this.element) {\r\n\t\t\tif (this.isIterateAfterHover(this.stepItem)) {\r\n\t\t\t\tthis.hoverListeners.add(this.element, 'mouseenter', this.iterateStepAfterUserAction.bind(this));\r\n\t\t\t\tthis.element.classList.add(CLASSES_CORE.target + MODIFIERS.hover);\r\n\t\t\t} else {\r\n\t\t\t\tthis.clearIterateAfterHover();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tclearIterateAfterHover() {\r\n\t\tif (this.element) {\r\n\t\t\tthis.element.classList.remove(CLASSES_CORE.target + MODIFIERS.hover);\r\n\t\t}\r\n\t}\r\n\r\n\tisIterateAfterHover() {\r\n\t\treturn this.stepItem\r\n\t\t\t&& this.stepItem.element\r\n\t\t\t&& this.stepItem.enable_interaction.val == '1'\r\n\t\t\t//&& !this.stepItem.isDummyElement\r\n\t\t\t&& this.stepItem.enable_interaction.ext?.iterate_after_hover == '1';\r\n\t}\r\n\r\n}\r\n"],"sourceRoot":""}