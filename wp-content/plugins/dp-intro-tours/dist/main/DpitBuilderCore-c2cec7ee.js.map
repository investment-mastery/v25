{"version":3,"sources":["webpack:///./public/assets/js/modules/core/DpitBuilderCore.js","webpack:///./node_modules/classnames/index.js"],"names":["LAYER_CLASSES_BUILDER","builderMode","builderInRun","builder","stepEditMode","targetSelectingMode","hovered","DpitBuilderCore","DpitCore","constructor","wrapEl","mainCfg","tourCfg","_this","dpDebugEn","console","log","super","this","_defineProperty","stepIdx","arguments","length","undefined","currentUrl","removeURLParameters","window","location","href","queryParamsDefs","currentUrlRel","absToRelativeUrl","siteUrl","newStepBasic","initStepParams","stepDefinitions","isNewStep","idx","step","url","unifyUrl","newStep","selector","element","$","stepItems","i","stepItem","updateIndexOfStepItem","options","showBullets","bulletsLayer","find","append","createBullet","onNavigBulletClick","bind","splice","stepItemBase","isAtEnd","newStepIdx","remove","optionsOverride","exitOnOverlayClick","exitOnEsc","leaveOverlayAlways","DpitHooks","init","addAction","EVENTS","onInit","buttonPrevEl","hover","doAction","onButtonHover","id","hoverIn","buttonNextEl","document","documentElement","classList","add","setAsEditMode","isEditMode","startByFirstStepItem","firstStepItem","hideIntroLayers","actualizeCurrentStep","startCoreBasic","startCore","isBackward","startStep","TargetType","TRIGGER","showBackgroundOverlay","initSteps","isAnyStepItem","onNoStepsInit","setInRunClasses","clearInRunClasses","shouldBeStepSkipped","isTargetInMobileMenu","STEP","mobileAltStepMode","mainElement","dpIntroBuilderContainer","createElement","className","appendChild","pauseTour","addDocumentClass","hideShadowOverlay","hideBackgroundOverlay","restoreTour","removeDocumentClass","reason","REFRESH_REASONS","restore","showIntroLayersDisabled","showShadowOverlay","actualizeThemeSpecifier","theme","getOnBeforeUnloadByLinkClickConfirmMessage","i18n","actualizeNavigButtonHoverState","isNextButton","isHovered","showIntroLayers","showWrapper","stepObject4Hooks","setOptions","onSkipButtonClick","alert","tour_ending_in_builder","actualizeEditPanelEl","editPanelEl","querySelector","editPanelBB","DpitBB","fromElement","isStickyEditPanel","winBB","width","isStickyEditPanelOpened","_this$editPanelEl","contains","forceScrollTopOffset","filterWinBoardMargin","margin","builderEditPanelBB","bottom","height","defaultBoardMarginPx","y","defaultWinBoardMarginMobSizeCoef","filterTooltipElRelPos","elRelPos","isDummyMode","winBoardBB","tooltipBB","targetBB","top","freeHeight","hasOwn","hasOwnProperty","classNames","classes","arg","argType","push","Array","isArray","inner","apply","toString","Object","prototype","includes","key","call","join","module","exports","default"],"mappings":";;;;;;;;;;;;;;;;8RAgBO,MAAMA,EAAwB,CACpCC,YAAa,oBACbC,aAAc,WACdC,QAAS,eACTC,aAAc,sBACdC,oBAAqB,wBACrBC,QAAS,gBAGK,MAAMC,UAAwBC,UAC5CC,YAAYC,EAAQC,EAASC,GAAU,IAADC,EACjCF,EAAQG,WAAWC,QAAQC,IAAI,+BACnCC,MAAMP,EAAQC,EAASC,GAAQC,EAAAK,KAAAC,YAAA,qBAiMjB,WAAqB,IAApBC,EAAOC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,KACT,OAAZD,IAAkBA,EAAUP,EAAKO,SAErC,MAAMI,EAAaC,YAAoBC,OAAOC,SAASC,KAAMf,EAAKF,QAAQkB,iBACpEC,EAAgBC,YAAiBP,EAAYX,EAAKF,QAAQqB,SAE1DC,EAAe,IACjBC,YAAerB,EAAKF,QAAQwB,iBAC/BC,WAAW,EACXC,IAAKjB,EACLkB,KAAMlB,EAAU,EAChBmB,IAAKnB,EAAU,EAAI,sBAAwBoB,YAASV,GAAe,IAG9DW,EAAU,IACZR,EACHS,SAAUT,EAAaU,QACvBA,QAASC,EAAEX,EAAaU,SAAS,IAAM,KACvCJ,IAAKnB,EAAU,EAAI,sBAAwBI,GAG5C,GAAIJ,EAAUP,EAAKgC,UAAUvB,OAC5B,IAAK,IAAIwB,EAAI1B,EAAS0B,EAAIjC,EAAKgC,UAAUvB,OAAQwB,IAAK,CACrD,MAAMC,EAAWlC,EAAKgC,UAAUC,GAChCjC,EAAKmC,sBAAsBD,EAAUA,EAASV,IAAM,GAOtD,OAJIxB,EAAKoC,QAAQC,aAChBN,EAAE/B,EAAKsC,cAAcC,KAAK,MAAMC,OAAOxC,EAAKyC,aAAazC,EAAKgC,UAAUvB,OAAS,GAAG,GAAM,EAAOT,EAAK0C,mBAAmBC,KAAK3C,KAE/HA,EAAKgC,UAAUY,OAAOrC,EAAS,EAAGqB,GAC3B,CACNiB,aAAczB,EACdc,SAAUN,MAEXtB,YAAA,qBAEc,WAAqB,IAApBC,EAAOC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,KACT,OAAZD,IAAkBA,EAAUP,EAAKO,SACrC,MAAMuC,EAAUvC,IAAYP,EAAKgC,UAAUvB,OAAS,EACpD,GAAIF,EAAUP,EAAKgC,UAAUvB,OAC5B,IAAK,IAAIwB,EAAI1B,EAAS0B,EAAIjC,EAAKgC,UAAUvB,OAAQwB,IAAK,CACrD,MAAMC,EAAWlC,EAAKgC,UAAUC,GAChCjC,EAAKmC,sBAAsBD,EAAUA,EAASV,IAAM,GAGtDxB,EAAKgC,UAAUY,OAAOrC,EAAS,GAC/B,MAAMwC,EAAaD,EAAU9C,EAAKO,QAAU,EAAIP,EAAKO,QAIrD,OAHIP,EAAKoC,QAAQC,aAChBN,EAAE/B,EAAKsC,cAAcC,KAAK,oBAAoBS,SAExCD,GAAc,EAAI/C,EAAKgC,UAAUe,GAAc,QAlPtD1C,KAAKN,QAAUA,EACfM,KAAKP,QAAUA,EACfO,KAAK4C,gBAAkB,CACtBC,oBAAoB,EACpBC,WAAW,EAEXC,oBAAoB,GAGrB/C,KAAK+B,QAAU,IAAK/B,KAAK+B,WAAY/B,KAAK4C,iBAC1CI,IAAUC,KAAKxD,EAAQG,WACvBoD,IAAUE,UAAUC,SAAOC,OAAQ,KAC9BpD,KAAKqD,cACR3B,EAAE1B,KAAKqD,cAAcC,MACpB,IAAMtD,KAAKuD,SAASJ,SAAOK,cAAe,CAAEC,GAAI,OAAQC,SAAS,IACjE,IAAM1D,KAAKuD,SAASJ,SAAOK,cAAe,CAAEC,GAAI,OAAQC,SAAS,KAI/D1D,KAAK2D,cACRjC,EAAE1B,KAAK2D,cAAcL,MACpB,IAAMtD,KAAKuD,SAASJ,SAAOK,cAAe,CAAEC,GAAI,OAAQC,SAAS,IACjE,IAAM1D,KAAKuD,SAASJ,SAAOK,cAAe,CAAEC,GAAI,OAAQC,SAAS,OAKpEE,SAASC,gBAAgBC,UAAUC,IAAIjF,EAAsBC,aAG9DiF,cAAcC,GACTA,EACHL,SAASC,gBAAgBC,UAAUC,IAAIjF,EAAsBI,cAE7D0E,SAASC,gBAAgBC,UAAUnB,OAAO7D,EAAsBI,cAWlEgF,qBAAqBC,GACpBnE,KAAKoE,iBAAgB,GAAO,GAAM,GAClCpE,KAAK2B,UAAY,CAACwC,GAClBnE,KAAKqE,qBAAqBF,GAC1BnE,KAAKsE,gBAAe,EAAOH,EAAcjE,SAI1CqE,YAA8C,IAApCC,EAAUrE,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,GAAUsE,EAAStE,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,EACrCH,KAAKP,QAAQV,cAAgB2F,IAAWC,SAC3C5E,MAAMwE,UAAUC,EAAYC,GAI9BG,wBACK5E,KAAKP,QAAQV,cAAgB2F,IAAWC,SAC3C5E,MAAM6E,wBAIRC,YACC,MAAMC,EAAgB/E,MAAM8E,YAE5B,OADA7E,KAAKuD,SAASJ,SAAO4B,eACdD,EAGRE,kBACCpB,SAASC,gBAAgBC,UAAUC,IAAIjF,EAAsBE,cAC7De,MAAMiF,kBAGPC,oBACCrB,SAASC,gBAAgBC,UAAUnB,OAAO7D,EAAsBE,cAChEe,MAAMiF,kBAGPE,oBAAoBrD,EAAUsD,GAC7B,OAAInF,KAAKP,QAAQV,cAAgB2F,IAAWU,OAASpF,KAAKP,QAAQ4F,mBAC1DtF,MAAMmF,oBAAoBrD,EAAUsD,GAK7C,4BAA4BG,GAC3B,IAAIC,EAA0B3B,SAAS4B,cAAc,OAGrD,OAFAD,EAAwBE,UAAY3G,EAAsBG,QAC1DqG,EAAYI,YAAYH,GACjBA,EAGRI,YAA8D,IAApDC,EAAgBzF,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,GAAsBA,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,KAEjDH,KAAK6F,oBACL7F,KAAK8F,yBAEF9F,KAAKP,QAAQV,cAAgB2F,IAAWU,MAC3CrF,MAAM4F,UAAUC,GAGlBG,cAA+F,IAAnFC,EAAmB7F,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,GAAI8F,EAAM9F,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG+F,kBAAgBC,QAAShC,EAAahE,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,KAClFH,KAAKoG,yBAAyBpG,KAAKqG,oBACpCrG,KAAKP,QAAQV,cAAgB2F,IAAWU,OACvCjB,IACHnE,KAAK2B,UAAY,CAACwC,GAClBnE,KAAKqE,qBAAqBF,IAE3BnE,KAAKsG,wBAAwBtG,KAAKN,QAAQ6G,OAC1CxG,MAAMgG,YAAYC,EAAqBC,IAIzCO,6CACC,OAAOC,YAAK,uBAAwBzG,KAAKP,QAAQgH,MAGlDC,+BAA+BC,EAAcC,GAC5C,MAAMnF,EAAUkF,EAAe3G,KAAK2D,aAAe3D,KAAKqD,aACpDuD,EACHnF,EAAQqC,UAAUC,IAAIjF,EAAsBM,SAE5CqC,EAAQqC,UAAUnB,OAAO7D,EAAsBM,SAKjDyH,kBAAqC,IAArBC,IAAW3G,UAAAC,OAAA,QAAAC,IAAAF,UAAA,KAAAA,UAAA,GACrBH,KAAKoG,yBAAyBrG,MAAM8G,gBAAgBC,GAG1DC,iBAAiBlF,GAChB,OAAOA,UAAY,KAGpBmF,WAAWjF,GACVhC,MAAMiH,WAAW,IAAKjF,KAAY/B,KAAK4C,kBAIxCqE,oBACCC,MAAMlH,KAAKP,QAAQgH,KAAKU,wBAGzBC,uBACMpH,KAAKqH,cAAarH,KAAKqH,YAAczD,SAAS0D,cAAc,uBAC7DtH,KAAKqH,YAAarH,KAAKuH,YAAcC,UAAOC,YAAYzH,KAAKqH,aAAa,GACzErH,KAAKuH,YAAc,KAGzBG,oBACC,OAAO1H,KAAK2H,OAAS3H,KAAK2H,MAAMC,OAAS,IAG1CC,0BAA2B,IAADC,EAEzB,OADA9H,KAAKoH,uBACEpH,KAAK0H,sBAAuC,QAApBI,EAAI9H,KAAKqH,mBAAW,IAAAS,OAAA,EAAhBA,EAAkBhE,UAAUiE,SAAS,8BAGzEC,uBACC,OAAOhI,KAAK6H,0BAIbI,qBAAqBC,GAEpB,GADAA,EAASnI,MAAMkI,qBAAqBC,GAChClI,KAAK6H,0BAA2B,CACnC,MAAMM,EAAqBX,UAAOC,YAAYzH,KAAKqH,aAAa,GAC5Dc,IACHD,EAAOE,OAASD,EAAmBE,OAASrI,KAAK+B,QAAQuG,qBAAqBC,EAAIvI,KAAK+B,QAAQyG,kCAGjG,OAAON,EAGRO,sBAAsBC,GACrB,GAAI1I,KAAK2I,eAAiB3I,KAAK6H,2BAA6B7H,KAAK2H,OAAS3H,KAAK4I,YAAc5I,KAAK6I,WAAa7I,KAAK8I,SACnH,GAAI9I,KAAK6I,UAAUR,QAAUrI,KAAK4I,WAAWP,OAC5CK,EAASK,IAAM/I,KAAK4I,WAAWG,IAAM/I,KAAK8I,SAASC,QAE/C,CACJ,MAAMC,EAAahJ,KAAKuH,YAAcvH,KAAK2H,MAAMU,OAASrI,KAAKuH,YAAYc,OAASrI,KAAK4I,WAAWP,OACpGK,EAASK,KAAOC,EAAahJ,KAAK6I,UAAUR,QAAU,EAAIrI,KAAK8I,SAASC,IAG1E,OAAOL,K,kBC1NT;;;;;GAIsB,WAAY,aAAa,IAAIO,EAAO,GAAGC,eAAoD,SAASC,IAA4B,IAAf,IAAIC,EAAQ,GAAWxH,EAAE,EAAEA,EAAEzB,UAAUC,OAAOwB,IAAI,CAAC,IAAIyH,EAAIlJ,UAAUyB,GAAG,GAAIyH,EAAJ,CAAiB,IAAIC,SAAeD,EAAI,GAAa,WAAVC,GAA8B,WAAVA,EAAoBF,EAAQG,KAAKF,QAAW,GAAGG,MAAMC,QAAQJ,IAAM,GAAGA,EAAIjJ,OAAO,CAAC,IAAIsJ,EAAMP,EAAWQ,MAAM,KAAKN,GAAQK,GAAON,EAAQG,KAAKG,SAAe,GAAa,WAAVJ,EAAmB,CAAC,GAAGD,EAAIO,WAAWC,OAAOC,UAAUF,WAAWP,EAAIO,SAASA,WAAWG,SAAS,iBAAiB,CAACX,EAAQG,KAAKF,EAAIO,YAAY,SAAU,IAAI,IAAII,KAAOX,EAAQJ,EAAOgB,KAAKZ,EAAIW,IAAMX,EAAIW,IAAMZ,EAAQG,KAAKS,KAAS,OAAOZ,EAAQc,KAAK,KAAsCC,EAAOC,SAASjB,EAAWkB,QAAQlB,EAAWgB,EAAOC,QAAQjB,QACztB,KAA/B,aAAY,OAAOA,GAAY,QAAjC,OAAiC,aAD/B","file":"main/DpitBuilderCore-c2cec7ee.js","sourcesContent":["import {\r\n\tEVENTS, REFRESH_REASONS\r\n} from './constants';\r\nimport DpitCore from './DpitCore';\r\nimport DpitHooks from '../../../../../includes/assets/js/modules/DpitHooks';\r\nimport {\r\n\tremoveURLParameters,\r\n\tabsToRelativeUrl,\r\n\tinitStepParams,\r\n\tunifyUrl\r\n} from '../../../../../includes/assets/js/modules/dpitUtilsInc';\r\nimport { TargetType } from '../../apps/TourStepEditor/store/appMode';\r\nimport DpitBB from './DpitBB';\r\nimport { i18n } from '../dpitUtilsPublic';\r\n\r\n\r\nexport const LAYER_CLASSES_BUILDER = {\r\n\tbuilderMode: 'dpit-builder-mode',\r\n\tbuilderInRun: 'dpit-bon',\r\n\tbuilder: 'dpit-builder',\r\n\tstepEditMode: 'dpit-step-edit-mode',\r\n\ttargetSelectingMode: 'dpit-target-selecting',\r\n\thovered: 'dpit-hovered'\r\n};\r\n\r\nexport default class DpitBuilderCore extends DpitCore {\r\n\tconstructor(wrapEl, mainCfg, tourCfg) {\r\n\t\tif (mainCfg.dpDebugEn) console.log('[dpit] INIT DpitBuilderCore');\r\n\t\tsuper(wrapEl, mainCfg, tourCfg);\r\n\r\n\t\tthis.tourCfg = tourCfg;\r\n\t\tthis.mainCfg = mainCfg;\r\n\t\tthis.optionsOverride = {\r\n\t\t\texitOnOverlayClick: false,\r\n\t\t\texitOnEsc: false,\r\n\t\t\t//centerTopBottomPosOffset: 120,\r\n\t\t\tleaveOverlayAlways: true\r\n\t\t};\r\n\r\n\t\tthis.options = { ...this.options, ...this.optionsOverride };\r\n\t\tDpitHooks.init(mainCfg.dpDebugEn);\r\n\t\tDpitHooks.addAction(EVENTS.onInit, () => {\r\n\t\t\tif (this.buttonPrevEl) {\r\n\t\t\t\t$(this.buttonPrevEl).hover(\r\n\t\t\t\t\t() => this.doAction(EVENTS.onButtonHover, { id: 'back', hoverIn: true }),\r\n\t\t\t\t\t() => this.doAction(EVENTS.onButtonHover, { id: 'back', hoverIn: false })\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\tif (this.buttonNextEl) {\r\n\t\t\t\t$(this.buttonNextEl).hover(\r\n\t\t\t\t\t() => this.doAction(EVENTS.onButtonHover, { id: 'next', hoverIn: true }),\r\n\t\t\t\t\t() => this.doAction(EVENTS.onButtonHover, { id: 'next', hoverIn: false })\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tdocument.documentElement.classList.add(LAYER_CLASSES_BUILDER.builderMode);\r\n\t}\r\n\r\n\tsetAsEditMode(isEditMode) {\r\n\t\tif (isEditMode) {\r\n\t\t\tdocument.documentElement.classList.add(LAYER_CLASSES_BUILDER.stepEditMode);\r\n\t\t} else {\r\n\t\t\tdocument.documentElement.classList.remove(LAYER_CLASSES_BUILDER.stepEditMode);\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t/**\r\n\t* Start a new intro tour\r\n\t*\r\n\t* @api private\r\n\t* @method startByFirstStepItem\r\n\t*/\r\n\tstartByFirstStepItem(firstStepItem) {\r\n\t\tthis.hideIntroLayers(false, true, true);\r\n\t\tthis.stepItems = [firstStepItem];\r\n\t\tthis.actualizeCurrentStep(firstStepItem);\r\n\t\tthis.startCoreBasic(false, firstStepItem.stepIdx);\r\n\t\t//this.showIntroLayers();\r\n\t}\r\n\r\n\tstartCore(isBackward = false, startStep = 0) {\r\n\t\tif (this.mainCfg.builderMode !== TargetType.TRIGGER) {\r\n\t\t\tsuper.startCore(isBackward, startStep);\r\n\t\t}\r\n\t}\r\n\r\n\tshowBackgroundOverlay() {\r\n\t\tif (this.mainCfg.builderMode !== TargetType.TRIGGER) {\r\n\t\t\tsuper.showBackgroundOverlay();\r\n\t\t}\r\n\t}\r\n\r\n\tinitSteps() {\r\n\t\tconst isAnyStepItem = super.initSteps();\r\n\t\tthis.doAction(EVENTS.onNoStepsInit);\r\n\t\treturn isAnyStepItem;\r\n\t}\r\n\r\n\tsetInRunClasses() {\r\n\t\tdocument.documentElement.classList.add(LAYER_CLASSES_BUILDER.builderInRun);\r\n\t\tsuper.setInRunClasses();\r\n\t}\r\n\r\n\tclearInRunClasses() {\r\n\t\tdocument.documentElement.classList.remove(LAYER_CLASSES_BUILDER.builderInRun);\r\n\t\tsuper.setInRunClasses();\r\n\t}\r\n\r\n\tshouldBeStepSkipped(stepItem, isTargetInMobileMenu) {\r\n\t\tif (this.mainCfg.builderMode === TargetType.STEP && !this.mainCfg.mobileAltStepMode) {\r\n\t\t\treturn super.shouldBeStepSkipped(stepItem, isTargetInMobileMenu);\r\n\t\t}\r\n\t\telse return false;\r\n\t}\r\n\r\n\tstatic initBuilderContainer(mainElement) {\r\n\t\tlet dpIntroBuilderContainer = document.createElement('div');\r\n\t\tdpIntroBuilderContainer.className = LAYER_CLASSES_BUILDER.builder;\r\n\t\tmainElement.appendChild(dpIntroBuilderContainer);\r\n\t\treturn dpIntroBuilderContainer;\r\n\t}\r\n\r\n\tpauseTour(addDocumentClass = '', leaveActiveOverlay = false) {\r\n\t\tif (!leaveActiveOverlay) {\r\n\t\t\tthis.hideShadowOverlay();\r\n\t\t\tthis.hideBackgroundOverlay();\r\n\t\t}\r\n\t\tif (this.mainCfg.builderMode === TargetType.STEP)\r\n\t\t\tsuper.pauseTour(addDocumentClass);\r\n\t}\r\n\r\n\trestoreTour(removeDocumentClass = '', reason = REFRESH_REASONS.restore, firstStepItem = null) {\r\n\t\tif (!this.showIntroLayersDisabled) this.showShadowOverlay();\r\n\t\tif (this.mainCfg.builderMode === TargetType.STEP) {\r\n\t\t\tif (firstStepItem) {\r\n\t\t\t\tthis.stepItems = [firstStepItem];\r\n\t\t\t\tthis.actualizeCurrentStep(firstStepItem);\r\n\t\t\t}\r\n\t\t\tthis.actualizeThemeSpecifier(this.tourCfg.theme);\r\n\t\t\tsuper.restoreTour(removeDocumentClass, reason);\r\n\t\t}\r\n\t}\r\n\r\n\tgetOnBeforeUnloadByLinkClickConfirmMessage() {\r\n\t\treturn i18n('end-a-tour-builder-q', this.mainCfg.i18n);\r\n\t}\r\n\r\n\tactualizeNavigButtonHoverState(isNextButton, isHovered) {\r\n\t\tconst element = isNextButton ? this.buttonNextEl : this.buttonPrevEl;\r\n\t\tif (isHovered) {\r\n\t\t\telement.classList.add(LAYER_CLASSES_BUILDER.hovered);\r\n\t\t} else {\r\n\t\t\telement.classList.remove(LAYER_CLASSES_BUILDER.hovered);\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tshowIntroLayers(showWrapper = true) {\r\n\t\tif (!this.showIntroLayersDisabled) super.showIntroLayers(showWrapper);\r\n\t}\r\n\r\n\tstepObject4Hooks(stepItem) {\r\n\t\treturn stepItem ?? null;\r\n\t}\r\n\r\n\tsetOptions(options) {\r\n\t\tsuper.setOptions({ ...options, ...this.optionsOverride });\r\n\t}\r\n\r\n\r\n\tonSkipButtonClick() {\r\n\t\talert(this.mainCfg.i18n.tour_ending_in_builder);\r\n\t}\r\n\r\n\tactualizeEditPanelEl() {\r\n\t\tif (!this.editPanelEl) this.editPanelEl = document.querySelector('.dp-pull-out-panel');\r\n\t\tif (this.editPanelEl) this.editPanelBB = DpitBB.fromElement(this.editPanelEl, true);\r\n\t\telse this.editPanelBB = null;\r\n\t}\r\n\r\n\tisStickyEditPanel() {\r\n\t\treturn this.winBB && this.winBB.width <= 480; // edit panel sticky on bottom under 480px\r\n\t}\r\n\r\n\tisStickyEditPanelOpened() {\r\n\t\tthis.actualizeEditPanelEl();\r\n\t\treturn this.isStickyEditPanel() && this.editPanelEl?.classList.contains('dp-pull-out-panel--active');\r\n\t}\r\n\r\n\tforceScrollTopOffset() {\r\n\t\treturn this.isStickyEditPanelOpened();\r\n\t}\r\n\r\n\r\n\tfilterWinBoardMargin(margin) {\r\n\t\tmargin = super.filterWinBoardMargin(margin);\r\n\t\tif (this.isStickyEditPanelOpened()) {\r\n\t\t\tconst builderEditPanelBB = DpitBB.fromElement(this.editPanelEl, true);\r\n\t\t\tif (builderEditPanelBB) {\r\n\t\t\t\tmargin.bottom = builderEditPanelBB.height + this.options.defaultBoardMarginPx.y * this.options.defaultWinBoardMarginMobSizeCoef;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn margin;\r\n\t}\r\n\r\n\tfilterTooltipElRelPos(elRelPos) {\r\n\t\tif (this.isDummyMode() && this.isStickyEditPanelOpened() && this.winBB && this.winBoardBB && this.tooltipBB && this.targetBB) {\r\n\t\t\tif (this.tooltipBB.height >= this.winBoardBB.height) {\r\n\t\t\t\telRelPos.top = this.winBoardBB.top - this.targetBB.top;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tconst freeHeight = this.editPanelBB ? this.winBB.height - this.editPanelBB.height : this.winBoardBB.height;\r\n\t\t\t\telRelPos.top = (freeHeight - this.tooltipBB.height) / 2 - this.targetBB.top;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn elRelPos;\r\n\t}\r\n\r\n\taddNewStepAt = (stepIdx = null) => {\r\n\t\tif (stepIdx === null) stepIdx = this.stepIdx;\r\n\r\n\t\tconst currentUrl = removeURLParameters(window.location.href, this.mainCfg.queryParamsDefs);\r\n\t\tconst currentUrlRel = absToRelativeUrl(currentUrl, this.mainCfg.siteUrl);\r\n\r\n\t\tconst newStepBasic = {\r\n\t\t\t...initStepParams(this.mainCfg.stepDefinitions),\r\n\t\t\tisNewStep: true,\r\n\t\t\tidx: stepIdx,\r\n\t\t\tstep: stepIdx + 1,\r\n\t\t\turl: stepIdx > 0 ? '$keep-prev-step-url' : unifyUrl(currentUrlRel, false)\r\n\t\t};\r\n\r\n\t\tconst newStep = {\r\n\t\t\t...newStepBasic,\r\n\t\t\tselector: newStepBasic.element,\r\n\t\t\telement: $(newStepBasic.element)[0] || null,\r\n\t\t\turl: stepIdx > 0 ? '$keep-prev-step-url' : currentUrl\r\n\t\t};\r\n\r\n\t\tif (stepIdx < this.stepItems.length) {\r\n\t\t\tfor (let i = stepIdx; i < this.stepItems.length; i++) {\r\n\t\t\t\tconst stepItem = this.stepItems[i];\r\n\t\t\t\tthis.updateIndexOfStepItem(stepItem, stepItem.idx + 1);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.options.showBullets) {\r\n\t\t\t$(this.bulletsLayer).find('ul').append(this.createBullet(this.stepItems.length + 1, true, false, this.onNavigBulletClick.bind(this)));\r\n\t\t}\r\n\t\tthis.stepItems.splice(stepIdx, 0, newStep);\r\n\t\treturn {\r\n\t\t\tstepItemBase: newStepBasic,\r\n\t\t\tstepItem: newStep\r\n\t\t};\r\n\t};\r\n\r\n\tremoveStepAt = (stepIdx = null) => {\r\n\t\tif (stepIdx === null) stepIdx = this.stepIdx;\r\n\t\tconst isAtEnd = stepIdx === this.stepItems.length - 1;\r\n\t\tif (stepIdx < this.stepItems.length) {\r\n\t\t\tfor (let i = stepIdx; i < this.stepItems.length; i++) {\r\n\t\t\t\tconst stepItem = this.stepItems[i];\r\n\t\t\t\tthis.updateIndexOfStepItem(stepItem, stepItem.idx - 1);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.stepItems.splice(stepIdx, 1);\r\n\t\tconst newStepIdx = isAtEnd ? this.stepIdx - 1 : this.stepIdx;\r\n\t\tif (this.options.showBullets) {\r\n\t\t\t$(this.bulletsLayer).find('ul li:last-child').remove();\r\n\t\t}\r\n\t\treturn newStepIdx >= 0 ? this.stepItems[newStepIdx] : null;\r\n\t};\r\n\r\n}","/*!\n\tCopyright (c) 2018 Jed Watson.\n\tLicensed under the MIT License (MIT), see\n\thttp://jedwatson.github.io/classnames\n*/ /* global define */(function(){'use strict';var hasOwn={}.hasOwnProperty;var nativeCodeString='[native code]';function classNames(){var classes=[];for(var i=0;i<arguments.length;i++){var arg=arguments[i];if(!arg)continue;var argType=typeof arg;if(argType==='string'||argType==='number'){classes.push(arg);}else if(Array.isArray(arg)){if(arg.length){var inner=classNames.apply(null,arg);if(inner){classes.push(inner);}}}else if(argType==='object'){if(arg.toString!==Object.prototype.toString&&!arg.toString.toString().includes('[native code]')){classes.push(arg.toString());continue;}for(var key in arg){if(hasOwn.call(arg,key)&&arg[key]){classes.push(key);}}}}return classes.join(' ');}if(typeof module!=='undefined'&&module.exports){classNames.default=classNames;module.exports=classNames;}else if(typeof define==='function'&&typeof define.amd==='object'&&define.amd){// register as 'classnames', consistent with npm package name\ndefine('classnames',[],function(){return classNames;});}else{window.classNames=classNames;}})();"],"sourceRoot":""}